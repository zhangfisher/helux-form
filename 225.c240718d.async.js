"use strict";(self.webpackChunkspeedform_docs=self.webpackChunkspeedform_docs||[]).push([[225],{38225:function(Xe,M,l){l.r(M),l.d(M,{$:function(){return s.$},ActionChildren:function(){return V},ComputedObjects:function(){return s.ComputedObjects},ComputedScopeRef:function(){return s.ComputedScopeRef},FieldChildren:function(){return D},OBJECT_PATH_DELIMITER:function(){return s.OBJECT_PATH_DELIMITER},SKIP_COMPUTED:function(){return s.SKIP_COMPUTED},ValidationError:function(){return Re},WatchObject:function(){return s.WatchObject},WatchObjects:function(){return s.WatchObjects},action:function(){return G},asyncComputedObject:function(){return s.asyncComputedObject},computed:function(){return s.computed},createActionComponent:function(){return R},createAsyncComputedMutate:function(){return s.createAsyncComputedMutate},createComputedMutate:function(){return s.createComputedMutate},createFieldComponent:function(){return L},createFieldGroupComponent:function(){return z},createForm:function(){return q},createObject:function(){return s.createObject},createStore:function(){return s.createStore},createUseAction:function(){return Q},createUseWatch:function(){return s.createUseWatch},createWatch:function(){return s.createWatch},defaultFormProps:function(){return Z},getAction:function(){return w},getSnap:function(){return s.getSnap},getVal:function(){return s.getVal},getValueByPath:function(){return s.getValueByPath},installComputed:function(){return s.installComputed},installWatch:function(){return s.installWatch},isIncludePath:function(){return s.isIncludePath},isSkipComputed:function(){return s.isSkipComputed},markRaw:function(){return s.markRaw},setAsyncComputedObject:function(){return s.setAsyncComputedObject},setVal:function(){return s.setVal},skipComputed:function(){return s.skipComputed},submit:function(){return ye},watch:function(){return s.watch}});var _=l(79664),F=l.n(_),ee=l(70125),C=l.n(ee),te=l(39114),S=l.n(te),h=l(70079),Ze=l(26851),E=l(59166);function qe(e){var n=_typeof(e);return e==null||n=="boolean"||n=="number"||n=="string"||n==null}function U(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=0,r,a=!0,u=function i(){if(r==null){a=!0,clearTimeout(t),t=0;return}try{var c=r;r=void 0,e.apply(void 0,F()(c)),t=setTimeout(function(){return i()},n)}finally{}};return function(){for(var i=arguments.length,c=new Array(i),o=0;o<i;o++)c[o]=arguments[o];if(n==0)return e.apply(void 0,c);r=c,(a||t==0)&&(a=!1,u())}}function _e(e,n){var t={};for(var r in e)e[r]!==n[r]&&(t[r]=n[r]);return t}function re(){return Math.random().toString(36).substring(2)}function W(e){return new Proxy({},{get:function(t,r,a){return e()[r]}})}function ne(e){return(0,E.P)(e)&&"execute"in e&&(0,E.P)(e.execute)&&"loading"in e.execute}function x(e){return(0,E.P)(e)&&"value"in e}function $(e){return Array.isArray(e)}function I(e){return(0,E.P)(e)&&!x(e)&&!ne(e)}function et(){return!1}var b="fields",tt="actions",T="validate",ue="$submit",s=l(38300),g=l(35250);function ae(e,n,t,r){return Object.assign({name:e,help:"",initial:void 0,oldValue:void 0,visible:!0,required:!1,readonly:!1,validate:null,enable:!0,placeholder:""},S()(S()({},n),{},{sync:t,update:r}))}function ie(e,n){var t=(0,h.useRef)(null);return(0,h.useCallback)(function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(t.current==null){var a=e.sync(n);t.current=r==0?a:U(a,r)}return t.current},[])}function ce(e,n){var t=(0,h.useRef)(null),r=(0,h.useState)(0),a=C()(r,2),u=a[0],i=a[1];return(0,h.useCallback)(function(c,o){var m=Object.assign({debounce:0},o),d=m.debounce;if(t.current==null||u!==d){u!==d&&d>0&&i(d);var f=function(p){return function(y){n(typeof p=="function"?function(A){return p.call(A,A.fields)}:function(A){return(0,s.setVal)(A,e,p)}),typeof y.preventDefault=="function"&&y.preventDefault()}};t.current=d>0?f:U(f,d)}return t.current(c)},[])}var D=h.memo(function(e){return(0,g.jsx)(g.Fragment,{children:typeof e.children=="function"&&e.children(e.fieldProps)})},function(e,n){return Object.entries(e.fieldProps).every(function(t){var r=C()(t,2),a=r[0],u=r[1];return["children","sync","update"].includes(a)?!0:u===n.fieldProps[a]})});function L(e,n){return h.memo(function(t){var r=t.name,a=Array.isArray(r)?r:r.split("."),u=[b].concat(F()(a)),i=[b].concat(F()(a));a.push("value"),i.push("value");var c=e.useState(function(y){return(0,s.getVal)(y,u)}),o=C()(c,2),m=o[0],d=o[1],f=ce(i,d),v=ie(e,i),p=ae(n.getFieldName(a),m,v,f);return t.render?(0,g.jsx)(D,{fieldProps:p,children:t.render}):Array.isArray(t.children)?t.children.map(function(y,A){return(0,g.jsx)(D,{fieldProps:p,children:y},A)}):(0,g.jsx)(D,{fieldProps:p,children:t.children})},function(t,r){return t.name===r.name})}var oe=l(90393),O=l.n(oe),se=l(7392),P=l.n(se),H=l(58048);function le(e,n){return(0,h.useCallback)(function(t){n(function(r){t.call(r,(0,s.getVal)(r,e))})},[])}function K(e,n,t){return(0,H.w)({name:e,help:"",visible:!0,required:!1,readonly:!1,validate:!0,enable:!0,update:t},n)}function z(e,n){return h.memo(function(t){var r=t.name,a=e.useState(),u=C()(a,2),i=u[0],c=u[1],o=Array.isArray(r)?r:r.split("."),m=["fields"].concat(F()(o)),d=(0,s.getVal)(i,m),f=le(m,c),v=(0,h.useState)(function(){return K(n.getFieldName(o),d,f)}),p=C()(v,2),y=p[0],A=p[1];return(0,h.useEffect)(function(){A(K(n.getFieldName(o),d,f))},[d]),Array.isArray(t.children)?t.children.map(function(Qe){return Qe(y)}):t.children(y)},function(t,r){return t.name===r.name})}var fe=l(6597);function J(e){return e.value}function N(e){var n={};return Object.entries(e).forEach(function(t){var r=C()(t,2),a=r[0],u=r[1];if(typeof a=="string")if(x(u))n[a]=J(u);else if(I(u)){var i=N(u);i&&Object.keys(i).length>0&&(n[a]=i)}else $(u)&&(n[a]=k(u))}),n}function k(e){var n=[];return e.forEach(function(t){x(t)?n.push(J(t)):I(t)?n.push(N(t)):$(t)?n.push(k(t)):n.push(t)}),n}function de(e,n,t){var r=Object.assign({},t),a=r.onNotMatch,u=a===void 0?function(){}:a;function i(c,o){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];Object.entries(c).forEach(function(d){var f=C()(d,2),v=f[0],p=f[1];if(typeof v=="string"){var y=[].concat(F()(m),[v]);if(v in o){var A=o[v];x(A)?A.value=p:I(A)?(0,E.P)(p)?i(p,A,y):u(y):$(A)?Array.isArray(p)?i(p,A):u(y):o[v]=p}else u(y)}})}i(e,n)}function rt(e,n){var t=new FormData,r=Object.assign({getItemName:function(c){return c.join(".")}},n),a=r.getItemName;function u(i,c){if(c!=null){var o=a?a(i):i.join(".");Array.isArray(c)?c.forEach(function(m,d){u([].concat(_toConsumableArray(i),[String(d)]),m)}):isPlainObject(c)?Object.entries(c).forEach(function(m){var d=_slicedToArray(m,2),f=d[0],v=d[1];u([].concat(_toConsumableArray(i),[f]),v)}):t.append(o,c)}}return u([],e),t}function ve(e,n){return function(r,a){var u=Object.assign({validate:!0},a);try{e.enableComputed(!1),de(r,e.state.fields),e.setState(function(i){i.dirty=!1,i.validate=null})}catch(i){console.error(i)}finally{e.enableComputed(!0),u!=null&&u.validate&&e.computedObjects.runGroup(T)}}}function Y(e,n){return N(e)}function me(e,n){return function(r){var a=Object.assign({},r);return Y((0,s.getSnap)(e.state).fields)}}function w(e,n){return function(){var t=P()(O()().mark(function r(a){var u;return O()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return u=Object.assign({},n,a),Array.isArray(u.scope)&&u.scope.length>0&&u.scope[0]!==b&&u.scope.unshift(b),c.next=4,e.execute.run(u);case 4:if(!e.execute.error){c.next=8;break}throw new Error(e.execute.error);case 8:return c.abrupt("return",e.execute.result);case 9:case"end":return c.stop()}},r)}));return function(r){return t.apply(this,arguments)}}()}function pe(e,n){return(0,h.useCallback)(function(t){var r=Object.assign({},{noReentry:!0,preventDefault:!0},n,t),a=w(e,r);return function(u){a(),u&&r.preventDefault&&typeof u.preventDefault=="function"&&u.preventDefault()}},[e])}function he(e,n){return(0,h.useCallback)(function(t){var r=(0,s.getValueByPath)(e,[].concat(F()(Array.isArray(n)?n:n.split(".")),["execute"]));r.cancel(),t&&typeof t.preventDefault=="function"&&t.preventDefault()},[])}function ge(e,n,t,r){return Object.assign({help:"",title:"",visible:!0,enable:!0},(0,fe.C)(e,"execute"),S()(S()({},e.execute),{},{run:n,cancel:t,ref:r}))}var V=h.memo(function(e){return(0,g.jsx)(g.Fragment,{children:typeof e.children=="function"&&e.children(e.actionProps)})},function(e,n){return Object.entries(e.actionProps).every(function(t){var r=C()(t,2),a=r[0],u=r[1];return["children","run","cancel"].includes(a)?!0:u===n.actionProps[a]})});function R(e,n){function t(r){var a=e.useState(),u=C()(a,1),i=u[0],c=r.name;c.includes(".")||(c="actions.".concat(c));var o=(0,s.getValueByPath)(i,c,"."),m=pe(o,r),d=he(i,c),f=(0,h.useRef)(null),v=ge(o,m,d,f);if(typeof r.render=="function")return(0,g.jsx)(V,{actionProps:v,children:r.render});if(r.children)return Array.isArray(r.children)?r.children.map(function(p,y){return(0,g.jsx)(V,{actionProps:v,children:p},y)}):(0,g.jsx)(V,{actionProps:v,children:r.children})}return h.memo(t,function(r,a){return r.name===a.name})}function G(e,n){return(0,s.computed)(function(){var t=P()(O()().mark(function r(a,u){var i;return O()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i=Y(Object.assign({},a)),o.next=3,e(i,u);case 3:return o.abrupt("return",o.sent);case 4:case"end":return o.stop()}},r)}));return function(r,a){return t.apply(this,arguments)}}(),[],n)}function ye(e,n){return G(function(){var t=P()(O()().mark(function r(a,u){var i;return O()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i=new FormData,o.next=3,e(i,u);case 3:return o.abrupt("return",o.sent);case 4:case"end":return o.stop()}},r)}));return function(r,a){return t.apply(this,arguments)}}(),n)}function Q(e){return function(t,r){var a=(0,h.useRef)(),u=e.useState(),i=C()(u,2),c=i[0],o=i[1],m=(0,h.useState)(function(){return r!=null&&r.name?r==null?void 0:r.name:re()}),d=C()(m,1),f=d[0];return a.current||(o(function(v){f in v.actions||(v.actions[f]={execute:G(t,r)})}),a.current=f),(0,s.getValueByPath)(c,["actions",f]).execute}}var be=l(20842),Ae=l(71698),je=l.n(Ae),Ce=l(41176),Oe=l.n(Ce),Fe=l(77937),Se=l.n(Fe),Pe=l(65523),Ee=l.n(Pe),Te=l(7122),xe=l.n(Te),De=l(19108),Ve=l.n(De),Re=function(e){Ee()(t,e);var n=xe()(t);function t(r){var a;return Se()(this,t),a=n.call(this,r),a.name="ValidationError",a}return Oe()(t)}(Ve()(Error));function X(e){return e.length>1&&e[0]==b&&(e[e.length-1]==="validate"||e.length>=2&&e[e.length-2]=="validate"&&e[e.length-1]=="result")&&!(e.length==2&&e[1]=="validate")&&!(e.length==3&&e[1]=="validate"&&e[2]=="result")}function $e(e){var n=Object.assign({},e),t=n.entry;return(0,s.watch)(function(r,a,u){if((0,s.isIncludePath)(t||u.path,r)){if(typeof a=="boolean"){var i=r.join(s.OBJECT_PATH_DELIMITER);a?delete u.cache[i]:u.cache[i]=a}return Object.keys(u.cache).length==0}},function(r){return X(r)},{initial:!0})}function nt(e,n){var t=typeof e=="function"?e():e;if(!t)throw new ValidationError(typeof n=="function"?n():n)}function Ie(e){return function(){var n=P()(O()().mark(function t(r){var a,u,i,c,o,m;return O()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(Array.isArray(r)&&r.length>0){a=r.join(s.OBJECT_PATH_DELIMITER),u=je()(e.computedObjects);try{for(u.s();!(i=u.n()).done;)c=C()(i.value,2),o=c[0],m=c[1],o.startsWith(a)&&m.run()}catch(v){u.e(v)}finally{u.f()}}else e.computedObjects.runGroup(T);case 1:case"end":return f.stop()}},t)}));return function(t){return n.apply(this,arguments)}}()}var Ne=l(8033);function we(e){var n={};return Object.entries(e||{}).forEach(function(t){var r=_slicedToArray(t,2),a=r[0],u=r[1];isFieldValue(u)||isFieldGroup(u)||isFieldList(u)||(n[a]=u)}),n}function Ge(e){return Object.assign({type:"submit",help:"",title:"",dirty:!1,validate:!0,visible:!0,enable:!0,readOnly:!0},we(e))}var B=null,Be=(0,Ne.zo)(function(e,n){var t,r=n.className,a=e.visible;return(0,g.jsx)("input",{className:r+" "+e.className,style:e.style,type:(t=e.type)!==null&&t!==void 0?t:"submit",value:e.title})},{cursor:"pointer",width:"100%",display:"block",boxSizing:"border-box",padding:"8px",borderRadius:"8px",transition:"filter 0.3s","&:hover":{filter:"brightness(1.2)"},"&.speedform-submit":{backgroundColor:"#54b2ff",color:"white",border:"1px solid #1e5786"}});function ut(e,n,t){var r=Object.assign({preventDefault:!1},n);function a(u){var i=e.useState(),c=_slicedToArray(i,1),o=c[0],m=u.scope,d=getValueByPath(o,m),f=Ge(d),v=typeof u.render=="function"?1:Array.isArray(u.children)?2:typeof u.children=="function"?3:0;return _jsxs(_Fragment,{children:[_jsx(Be,_objectSpread({visible:v==0},r)),v===1?_jsx(B,{submitProps:f,children:u.render}):v===2?u.children.map(function(p,y){return _jsx(B,{submitProps:f,children:p},y)}):_jsx(B,{submitProps:f,children:u.children})]})}return React.memo(a,function(u,i){return u.scope===i.scope})}function Me(e,n){var t=R(e,n);return function(r){return(0,g.jsx)(t,S()(S()({},r),{},{name:ue,children:function(u){var i=u.title,c=u.visible,o=u.loading,m=u.enable,d=u.run,f=u.cancel,v=u.error,p=u.progress;return(0,g.jsxs)("div",{className:"speedform-submit",children:["\u63D0\u4EA4",(0,g.jsx)("input",{type:"submit"}),(0,g.jsx)("span",{children:o?"\u63D0\u4EA4\u4E2D":"\u5DF2\u63D0\u4EA4"})]})}}))}}function Ue(e,n){var t=R(e,n);return function(r){return(0,g.jsx)(t,{name:"ffff",children:function(u){return(0,g.jsx)("input",{type:"submit",value:r.title})}})}}function We(e){return e.length>1&&e[0]==b&&e[e.length-1]=="value"}function Le(e){return(0,s.watch)(function(n,t,r){if((0,s.isIncludePath)(e||r.path,n)&&!r.value)return!0},function(n){return We(n)},{initial:!1})}var Z={name:"SpeedForm",title:"SpeedForm",help:"",tips:"",status:"idle",dirty:Le(["fields"]),validate:$e({entry:["fields"]}),readonly:!1,enable:!0,visible:!0,actions:{},fields:{}};function He(e,n,t,r){e.length>=2&&e[0]==b&&e[e.length-1]==T&&(t.scope||(t.scope="value"),t.depends||(t.depends=[]),t.depends.push([].concat(F()(e.slice(0,-1)),["value"])),t.initial=null,t.group=T,t.enable=!0)}function Ke(e){return(0,be.w)(e,Z)}function ze(e,n,t){e.length>1&&e[e.length-1]=="execute"&&(t.immediate=!1,t.scope?Array.isArray(t.scope)&&t.scope.length>0&&t.scope[0]!=b&&t.scope.unshift(b):t.scope=[b],t.noReentry=!0)}function Je(e,n,t){e.length>0&&e[0]==b&&t.depends&&t.depends.forEach(function(r,a){Array.isArray(r)&&r.length>0&&r[0]!=b?t.depends[a]=[b].concat(F()(r)):typeof r=="string"&&!r.startsWith("".concat(b,"."))&&(t.depends[a]="".concat(b,".").concat(r))})}function ke(e){return function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;e.enableComputed(n)}}function q(e,n){var t=(0,H.w)({getFieldName:function(i){return i.length>0?i[i.length-1]==="value"?i.slice(0,-1).join("."):i.join("."):""},validAt:"once"},n);Ke(e);var r=(0,s.createStore)(e,{debug:t.debug,scope:function(){return[b]},onCreateComputed:function(i,c,o){He(i,c,o,t),Je(i,c,o),ze(i,c,o)},onComputedDraft:function(i,c){var o=c.computedType,m=c.valuePath;if(o==="Computed"&&m.length>0&&m[0]==b)return i.fields}});r.on("computed:created",function(u){X(u.path)&&(u.options.enable=t.validAt==="once")});var a=r;return{state:a.state,useState:a.useState,setState:a.setState,Form:Ye(a,t),Field:L(a,t),Group:z(a,t),Action:R(a,t),Submit:Me(a,t),Reset:Ue(a,t),useAction:Q(a),fields:W(function(){return a.state.fields}),actions:W(function(){return a.state.actions}),getAction:w,freeze:ke(r),load:ve(a,t),getValues:me(a,t),computedObjects:a.computedObjects,watchObjects:a.watchObjects,validate:Ie(a)}}function Ye(e,n){return h.forwardRef(function(t,r){var a=t.children,u=(0,h.useCallback)(function(c){n.validAt==="submit"&&e.computedObjects.runGroup(T)},[]),i=(0,h.useCallback)(function(c){},[]);return(0,g.jsx)("form",S()(S()({ref:r,className:"speedform"},t),{},{onSubmit:u,onReset:i,children:a}))})}var j=q({title:(0,s.computed)(P()(O()().mark(function e(){return O()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return","true");case 1:case"end":return t.stop()}},e)}))),fields:{username:{value:""},password:{value:""},age:{value:!0,validate:(0,s.computed)(P()(O()().mark(function e(){return O()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",!0);case 1:case"end":return t.stop()}},e)})),["username"])},wifi:{ssid:{value:111111},password:{value:""}}},actions:{}});j.fields.username.value="123",j.state.fields.username.value="123",j.state,j.state.fields.age.value=!0,j.state.fields.age.validate,j.state.fields.wifi.password.value,j.state.fields.wifi.ssid.value,j.state.title,j.state.dirty=!0,j.state.fields.wifi.password.value,j.state.validate=!0,j.fields.age.value=!0,j.setState(function(e){e.fields.username.value="123",e.fields.age.value=!0,e.fields.wifi.password.value="123",e.dirty=!0,j.state.fields.age.validate.loading})}}]);
