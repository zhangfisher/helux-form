"use strict";(self.webpackChunkspeedform_docs=self.webpackChunkspeedform_docs||[]).push([[772],{65772:function(Ye,M,l){l.r(M),l.d(M,{ActionChildren:function(){return T},FieldChildren:function(){return $},ValidationError:function(){return Ve},action:function(){return X},createActionComponent:function(){return Q},createFieldComponent:function(){return w},createFieldGroupComponent:function(){return H},createForm:function(){return He},createUseAction:function(){return Z},getAction:function(){return G},submit:function(){return ge}});var q=l(79664),F=l.n(q),_=l(70125),j=l.n(_),ee=l(39114),O=l.n(ee),m=l(70079),Je=l(26851),P=l(13192);function Qe(e){var r=_typeof(e);return e==null||r=="boolean"||r=="number"||r=="string"||r==null}function K(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=0,t,u=!0,a=function i(){if(t==null){u=!0,clearTimeout(n),n=0;return}try{var o=t;t=void 0,e.apply(void 0,F()(o)),n=setTimeout(function(){return i()},r)}finally{}};return function(){for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];if(r==0)return e.apply(void 0,o);t=o,(u||n==0)&&(u=!1,a())}}function Xe(e,r){var n={};for(var t in e)e[t]!==r[t]&&(n[t]=r[t]);return n}function U(e){return new Proxy({},{get:function(n,t,u){return e()[t]}})}function ne(e){return(0,P.P)(e)&&"execute"in e&&(0,P.P)(e.execute)&&"loading"in e.execute}function E(e){return(0,P.P)(e)&&"value"in e}function R(e){return Array.isArray(e)}function D(e){return(0,P.P)(e)&&!E(e)&&!ne(e)}var A="fields",Ze="actions",y=l(59664),h=l(35250);function te(e,r,n,t){return Object.assign({name:e,help:"",initial:void 0,oldValue:void 0,visible:!0,required:!1,readonly:!1,validate:null,enable:!0,placeholder:""},O()(O()({},r),{},{sync:n,update:t}))}function re(e,r){var n=(0,m.useRef)(null);return(0,m.useCallback)(function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(n.current==null){var u=e.sync(r);n.current=t==0?u:K(u,t)}return n.current},[])}function ue(e,r){var n=(0,m.useRef)(null),t=(0,m.useState)(0),u=j()(t,2),a=u[0],i=u[1];return(0,m.useCallback)(function(o,c){var s=Object.assign({debounce:0},c),f=s.debounce;if(n.current==null||a!==f){a!==f&&f>0&&i(f);var d=function(v){return function(b){r(typeof v=="function"?function(g){return v.call(g,g.fields)}:function(g){return(0,y.setVal)(g,e,v)}),typeof b.preventDefault=="function"&&b.preventDefault()}};n.current=f>0?d:K(d,f)}return n.current(o)},[])}var $=m.memo(function(e){return(0,h.jsx)(h.Fragment,{children:typeof e.children=="function"&&e.children(e.fieldProps)})},function(e,r){return Object.entries(e.fieldProps).every(function(n){var t=j()(n,2),u=t[0],a=t[1];return["children","sync","update"].includes(u)?!0:a===r.fieldProps[u]})});function w(e){var r=this;return m.memo(function(n){var t=n.name,u=Array.isArray(t)?t:t.split("."),a=[A].concat(F()(u)),i=[A].concat(F()(u));u.push("value"),i.push("value");var o=e.useState(function(b){return(0,y.getVal)(b,a)}),c=j()(o,2),s=c[0],f=c[1],d=ue(i,f),p=re(e,i),v=te(r.getFieldName(u),s,p,d);return n.render?(0,h.jsx)($,{fieldProps:v,children:n.render}):Array.isArray(n.children)?n.children.map(function(b){return(0,h.jsx)($,{fieldProps:v,children:b})}):(0,h.jsx)($,{fieldProps:v,children:n.children})},function(n,t){return n.name===t.name})}var ae=l(90393),C=l.n(ae),ie=l(7392),V=l.n(ie),L=l(23893);function ce(e,r){return(0,m.useCallback)(function(n){r(function(t){n.call(t,(0,y.getVal)(t,e))})},[])}function z(e,r,n){return(0,L.w)({name:e,help:"",visible:!0,required:!1,readonly:!1,validate:!0,enable:!0,update:n},r)}function H(e){var r=this;return m.memo(function(t){var u=t.name,a=e.useState(),i=j()(a,2),o=i[0],c=i[1],s=Array.isArray(u)?u:u.split("."),f=["fields"].concat(F()(s)),d=(0,y.getVal)(o,f),p=ce(f,c),v=(0,m.useState)(function(){return z(r.getFieldName(s),d,p)}),b=j()(v,2),g=b[0],S=b[1];return(0,m.useEffect)(function(){S(z(r.getFieldName(s),d,p))},[d]),Array.isArray(t.children)?t.children.map(function(I){return I(g)}):t.children(g)},function(n,t){return n.name===t.name})}var oe=l(76120);function W(e){return e.value}function N(e){var r={};return Object.entries(e).forEach(function(n){var t=j()(n,2),u=t[0],a=t[1];if(typeof u=="string")if(E(a))r[u]=W(a);else if(D(a)){var i=N(a);i&&Object.keys(i).length>0&&(r[u]=i)}else R(a)&&(r[u]=Y(a))}),r}function Y(e){var r=[];return e.forEach(function(n){E(n)?r.push(W(n)):D(n)?r.push(N(n)):R(n)?r.push(Y(n)):r.push(n)}),r}function le(e,r,n){var t=Object.assign({},n),u=t.onNotMatch,a=u===void 0?function(){}:u;function i(o,c){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];Object.entries(o).forEach(function(f){var d=j()(f,2),p=d[0],v=d[1];if(typeof p=="string"){var b=[].concat(F()(s),[p]);if(p in c){var g=c[p];E(g)?g.value=v:D(g)?(0,P.P)(v)?i(v,g,b):a(b):R(g)?Array.isArray(v)?i(v,g):a(b):c[p]=v}else a(b)}})}i(e,r)}function ke(e,r){var n=new FormData,t=Object.assign({getItemName:function(o){return o.join(".")}},r),u=t.getItemName;function a(i,o){if(o!=null){var c=u?u(i):i.join(".");Array.isArray(o)?o.forEach(function(s,f){a([].concat(_toConsumableArray(i),[String(f)]),s)}):isPlainObject(o)?Object.entries(o).forEach(function(s){var f=_slicedToArray(s,2),d=f[0],p=f[1];a([].concat(_toConsumableArray(i),[d]),p)}):n.append(c,o)}}return a([],e),n}function se(e,r){return function(t,u){var a=Object.assign({validate:!0},u);try{e.setEnableMutate(!1),le(t,e.state.fields),e.setState(function(i){i.dirty=!1,i.validate=null})}catch(i){console.error(i)}finally{e.setEnableMutate(!0),a!=null&&a.validate&&e.computedObjects.run("@validate")}}}function J(e,r){return N(e)}function fe(e,r){return function(t){var u=Object.assign({},t);return J((0,y.getSnap)(e.state).fields)}}function G(e,r){return function(){var n=V()(C()().mark(function t(u){var a;return C()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a=Object.assign({},r,u),o.next=3,e.execute.run(a);case 3:if(!e.execute.error){o.next=7;break}throw new Error(e.execute.error);case 7:return o.abrupt("return",e.execute.result);case 8:case"end":return o.stop()}},t)}));return function(t){return n.apply(this,arguments)}}()}function de(e,r){var n=(0,m.useCallback)(function(u){var a=Object.assign({},{noReentry:!0,preventDefault:!0},r,u),i=G(e,a);return function(o){i(),o&&a.preventDefault&&typeof o.preventDefault=="function"&&o.preventDefault()}},[e]),t=(0,m.useCallback)(function(u){e.execute.cancel(),u&&typeof u.preventDefault=="function"&&u.preventDefault()},[e]);return[n,t]}function ve(e,r){return(0,m.useCallback)(function(n){var t=(0,y.getValueByPath)(e,[].concat(F()(Array.isArray(r)?r:r.split(".")),["execute"]));t.cancel(),n&&typeof n.preventDefault=="function"&&n.preventDefault()},[])}function me(e,r,n,t){return Object.assign({help:"",title:"",visible:!0,enable:!0},(0,oe.C)(e,"execute"),O()(O()({},e.execute),{},{run:r,cancel:n,ref:t}))}var T=m.memo(function(e){return(0,h.jsx)(h.Fragment,{children:typeof e.children=="function"&&e.children(e.actionProps)})},function(e,r){return Object.entries(e.actionProps).every(function(n){var t=j()(n,2),u=t[0],a=t[1];return["children","run","cancel"].includes(u)?!0:a===r.actionProps[u]})});function Q(e,r,n){function t(u){var a=e.useState(),i=j()(a,1),o=i[0],c=u.name;c.includes(".")||(c="actions.".concat(c));var s=(0,y.getValueByPath)(o,c,"."),f=de(s,r),d=j()(f,1),p=d[0],v=ve(o,c),b=(0,m.useRef)(null),g=me(s,p,v,b);if(typeof u.render=="function")return(0,h.jsx)(T,{actionProps:g,children:u.render});if(u.children)return Array.isArray(u.children)?u.children.map(function(S){return(0,h.jsx)(T,{actionProps:g,children:S})}):(0,h.jsx)(T,{actionProps:g,children:u.children})}return m.memo(t,function(u,a){return u.name===a.name})}function X(e,r){return(0,y.computed)(function(){var n=V()(C()().mark(function t(u,a){var i;return C()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return i=J((0,y.getSnap)(u,!1).fields),c.next=3,e(i,a);case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},t)}));return function(t,u){return n.apply(this,arguments)}}(),[],r)}function ge(e,r){return X(function(){var n=V()(C()().mark(function t(u,a){var i;return C()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return i=new FormData,c.next=3,e(i,a);case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},t)}));return function(t,u){return n.apply(this,arguments)}}(),r)}function Z(e,r){return function(t,u){var a=e.useState(),i=j()(a,2),o=i[0],c=i[1],s=(0,m.useState)(function(){return Math.random().toString(36).substring(2)}),f=j()(s,2),d=f[0],p=f[1];return c(function(v){d in v.actions||(v.actions[d]={execute:(0,y.computed)(function(){var b=V()(C()().mark(function g(S,I){return C()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,t(S,I);case 2:return x.abrupt("return",x.sent);case 3:case"end":return x.stop()}},g)}));return function(g,S){return b.apply(this,arguments)}}(),[],u)})}),(0,m.useEffect)(function(){return function(){c(function(v){try{debugger;e.computedObjects.delete("actions/".concat(d,"/execute")),delete v.actions[d]}catch(b){debugger}})}},[]),(0,y.getValueByPath)(o,["actions",d]).execute}}var he=l(83443);function pe(e){return e.length>1&&e[0]==A&&e[e.length-1]=="value"}function ye(e){return(0,y.watch)(function(r,n){var t=n.getSelfValue,u=n.triggerPath,a=n.selfPath;if((0,y.isIncludePath)(e||a,u)){var i=t();if(!i)return!0}},function(r){return pe(r)},{initial:!1})}var be=l(41176),je=l.n(be),Ae=l(77937),Ce=l.n(Ae),Oe=l(65523),Fe=l.n(Oe),Se=l(7122),xe=l.n(Se),Pe=l(19108),Ee=l.n(Pe),Ve=function(e){Fe()(n,e);var r=xe()(n);function n(t){var u;return Ce()(this,n),u=r.call(this,t),u.name="ValidationError",u}return je()(n)}(Ee()(Error));function Re(e){return e.length>1&&e[0]==A&&(e[e.length-1]==="validate"||e.length>=2&&e[e.length-2]=="validate"&&e[e.length-1]=="result")&&!(e.length==2&&e[1]=="validate")&&!(e.length==3&&e[1]=="validate"&&e[2]=="result")}function De(e){var r=Object.assign({},e),n=r.entry;return(0,y.watch)(function(t,u){var a=u.triggerPath,i=u.selfPath,o=u.getCache;if((0,y.isIncludePath)(n||i,a)){var c=o();if(typeof t=="boolean"){var s=a.join(y.OBJECT_PATH_DELIMITER);t?delete c[s]:c[s]=t}return Object.keys(c).length==0}},function(t){return Re(t)},{initial:!0})}function qe(e,r){var n=typeof e=="function"?e():e;if(!n)throw new ValidationError(typeof r=="function"?r():r)}var $e={title:"SpeedForm",help:"",tips:"",status:"idle",dirty:ye(["fields"]),validate:De({entry:["fields"]}),readonly:!1,enable:!0,visible:!0},Te=l(83038);function Ne(e){var r={};return Object.entries(e||{}).forEach(function(n){var t=j()(n,2),u=t[0],a=t[1];E(a)||D(a)||R(a)||(r[u]=a)}),r}function Ge(e){return Object.assign({type:"submit",help:"",title:"",dirty:!1,validate:!0,visible:!0,enable:!0,readOnly:!0},Ne(e))}var B=m.memo(function(e){return(0,h.jsx)(h.Fragment,{children:typeof e.children=="function"&&e.children(e.submitProps)})},function(e,r){return Object.entries(e.submitProps).every(function(n){var t=j()(n,2),u=t[0],a=t[1];return["children","render"].includes(u)?!0:a===r.submitProps[u]})}),Be=(0,Te.zo)(function(e,r){var n,t,u=r.className,a=e.visible;return(0,h.jsx)("input",{className:u,style:Object.assign({display:a?"inline-block":"none"},e.style),type:(n=e.type)!==null&&n!==void 0?n:"submit",value:(t=e.title)!==null&&t!==void 0?t:"\u63D0\u4EA4"})},{minWidth:"80px",cursor:"pointer",boxSizing:"border-box",margin:"2px",transition:"filter 0.3s","&:hover":{filter:"brightness(1.2)"}});function k(e,r,n){var t=Object.assign({preventDefault:!1},r);function u(a){var i=e.useState(),o=j()(i,1),c=o[0],s=a.scope,f=(0,y.getValueByPath)(c,s),d=Ge(f),p=typeof a.render=="function"?1:Array.isArray(a.children)?2:typeof a.children=="function"?3:0;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Be,O()({visible:p==0},t)),p===1?(0,h.jsx)(B,{submitProps:d,children:a.render}):p===2?a.children.map(function(v){return(0,h.jsx)(B,{submitProps:d,children:v})}):(0,h.jsx)(B,{submitProps:d,children:a.children})]})}return m.memo(u,function(a,i){return a.name===i.name})}function Ie(e,r,n){return k(e,O()({type:"submit",title:"\u63D0\u4EA4",style:{borderRadius:"4px",padding:"8px",background:"#1c8ceb",border:"1px solid #1c8ceb",color:"#fff"}},r),n)}function Me(e,r,n){return k(e,O()({type:"reset",title:"\u91CD\u7F6E",style:{borderRadius:"4px",padding:"8px",background:"#eee",border:"1px solid #bbb"}},r),n)}function Ke(e,r,n){e.length>=2&&e[0]==A&&e[e.length-1]=="validate"&&(n.scope||(n.scope="value"),n.depends||(n.depends=[]),n.depends.push([].concat(F()(e.slice(0,-1)),["value"])),n.initial=null,n.group="validate")}function Ue(e){(0,he.w)(e,$e)}function we(e,r,n){e.length>1&&e[e.length-1]=="execute"&&(n.immediate=!1,n.scope=[A],n.noReentry=!0)}function Le(e,r,n){e.length>0&&e[0]==A&&n.depends&&n.depends.forEach(function(t,u){Array.isArray(t)&&t.length>0&&t[0]!=A?n.depends[u]=[A].concat(F()(t)):typeof t=="string"&&!t.startsWith("".concat(A,"."))&&(n.depends[u]="".concat(A,".").concat(t))})}function ze(e){return function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;e.setEnableMutate(r)}}function He(e,r){var n=(0,L.w)({getFieldName:function(a){return a.length>0?a[a.length-1]==="value"?a.slice(0,-1).join("."):a.join("."):""},singleton:!0},r);Ue(e);var t=(0,y.createStore)({state:e},{debug:n.debug,singleton:n.singleton,computedThis:function(){return y.ComputedScopeRef.Root},computedScope:function(){return[A]},onCreateComputed:function(a,i,o){Ke(a,i,o),Le(a,i,o),we(a,i,o)},onComputedContext:function(a,i){var o=i.computedType,c=i.contextType,s=i.valuePath;if(o==="Computed"&&c=="scope"&&s.length>0&&s[0]==A)return a.fields}});return{Form:We.call(n,t),Field:w.call(n,t),Group:H.call(n,t),Action:Q(t,{},n),Submit:Ie(t,{},n),Reset:Me(t,{},n),getAction:G,useAction:Z(t,n),fields:U(function(){return t.state.fields}),actions:U(function(){return t.state.actions}),state:t.state,useState:t.useState,freeze:ze(t),load:se(t,n),getValues:fe(t,n),computedObjects:t.computedObjects,watchObjects:t.watchObjects,store:t,validate:function(){var u=V()(C()().mark(function i(){return C()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",t.computedObjects.runGroup("validate"));case 1:case"end":return c.stop()}},i)}));function a(){return u.apply(this,arguments)}return a}()}}function We(e){return m.forwardRef(function(r,n){var t=r.children,u=(0,m.useCallback)(function(i){},[]),a=(0,m.useCallback)(function(i){},[]);return(0,h.jsx)("form",O()(O()({ref:n,className:"speedform-form"},r),{},{onSubmit:u,onReset:a,children:t}))})}}}]);
