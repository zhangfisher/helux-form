(self.webpackChunkspeedform_docs=self.webpackChunkspeedform_docs||[]).push([[922],{27271:function(L,A,l){"use strict";l.r(A),l.d(A,{$:function(){return o.$},ActionChildren:function(){return R},ComputedObjects:function(){return o.ComputedObjects},ComputedScopeRef:function(){return o.ComputedScopeRef},FieldChildren:function(){return V},OBJECT_PATH_DELIMITER:function(){return o.OBJECT_PATH_DELIMITER},SKIP_COMPUTED:function(){return o.SKIP_COMPUTED},ValidationError:function(){return Ie},WatchObject:function(){return o.WatchObject},WatchObjects:function(){return o.WatchObjects},action:function(){return M},computed:function(){return o.computed},createActionComponent:function(){return I},createAsyncComputedMutate:function(){return o.createAsyncComputedMutate},createAsyncComputedObject:function(){return o.createAsyncComputedObject},createComputedMutate:function(){return o.createComputedMutate},createFieldComponent:function(){return w},createFieldGroupComponent:function(){return J},createForm:function(){return q},createObject:function(){return o.createObject},createStore:function(){return o.createStore},createUseAction:function(){return X},createUseWatch:function(){return o.createUseWatch},createWatch:function(){return o.createWatch},getAction:function(){return B},getSnap:function(){return o.getSnap},getVal:function(){return o.getVal},getValueByPath:function(){return o.getValueByPath},installComputed:function(){return o.installComputed},installWatch:function(){return o.installWatch},isIncludePath:function(){return o.isIncludePath},isSkipComputed:function(){return o.isSkipComputed},markRaw:function(){return o.markRaw},reactive:function(){return o.reactive},setAsyncComputedObject:function(){return o.setAsyncComputedObject},setVal:function(){return o.setVal},skipComputed:function(){return o.skipComputed},submit:function(){return ge},useForm:function(){return Qe},watch:function(){return o.watch}});var T=l(79664),O=l.n(T),_=l(70125),j=l.n(_),ee=l(39114),F=l.n(ee),p=l(70079),qe=l(26851),S=l(79532);function _e(e){var u=_typeof(e);return e==null||u=="boolean"||u=="number"||u=="string"||u==null}function W(e){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=0,n,a=!0,r=function i(){if(n==null){a=!0,clearTimeout(t),t=0;return}try{var c=n;n=void 0,e.apply(void 0,O()(c)),t=setTimeout(function(){return i()},u)}finally{}};return function(){for(var i=arguments.length,c=new Array(i),s=0;s<i;s++)c[s]=arguments[s];if(u==0)return e.apply(void 0,c);n=c,(a||t==0)&&(a=!1,r())}}function et(e,u){var t={};for(var n in e)e[n]!==u[n]&&(t[n]=u[n]);return t}function te(){return Math.random().toString(36).substring(2)}function H(e){return new Proxy({},{get:function(t,n,a){return e()[n]}})}function ne(e){return(0,S.P)(e)&&"execute"in e&&(0,S.P)(e.execute)&&"loading"in e.execute}function E(e){return(0,S.P)(e)&&"value"in e}function $(e){return Array.isArray(e)}function N(e){return(0,S.P)(e)&&!E(e)&&!ne(e)}function tt(){return!1}var y="fields",nt="actions",x="validate",re="$submit",o=l(81015),g=l(35250);function ue(e,u,t,n){return Object.assign({name:e,help:"",initial:void 0,oldValue:void 0,visible:!0,required:!1,readonly:!1,validate:null,enable:!0,placeholder:""},F()(F()({},u),{},{sync:t,update:n}))}function ae(e,u){var t=(0,p.useRef)(null);return(0,p.useCallback)(function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(t.current==null){var a=e.sync(u);t.current=n==0?a:W(a,n)}return t.current},[])}function ie(e,u){var t=(0,p.useRef)(null),n=(0,p.useState)(0),a=j()(n,2),r=a[0],i=a[1];return(0,p.useCallback)(function(c,s){var v=Object.assign({debounce:0},s),m=v.debounce;if(t.current==null||r!==m){r!==m&&m>0&&i(m);var f=function(h){return function(b){u(typeof h=="function"?function(C){return h.call(C,C.fields)}:function(C){return(0,o.setVal)(C,e,h)}),typeof b.preventDefault=="function"&&b.preventDefault()}};t.current=m>0?f:W(f,m)}return t.current(c)},[])}var V=p.memo(function(e){return(0,g.jsx)(g.Fragment,{children:typeof e.children=="function"&&e.children(e.fieldProps)})},function(e,u){return Object.entries(e.fieldProps).every(function(t){var n=j()(t,2),a=n[0],r=n[1];return["children","sync","update"].includes(a)?!0:r===u.fieldProps[a]})});function w(e){var u=this;return p.memo(function(t){var n=t.name,a=Array.isArray(n)?n:n.split("."),r=[y].concat(O()(a)),i=[y].concat(O()(a));a.push("value"),i.push("value");var c=e.useState(function(b){return(0,o.getVal)(b,r)}),s=j()(c,2),v=s[0],m=s[1],f=ie(i,m),d=ae(e,i),h=ue(u.getFieldName(a),v,d,f);return t.render?(0,g.jsx)(V,{fieldProps:h,children:t.render}):Array.isArray(t.children)?t.children.map(function(b){return(0,g.jsx)(V,{fieldProps:h,children:b})}):(0,g.jsx)(V,{fieldProps:h,children:t.children})},function(t,n){return t.name===n.name})}var K=l(14262);function ce(e,u){return(0,p.useCallback)(function(t){u(function(n){t.call(n,(0,o.getVal)(n,e))})},[])}function z(e,u,t){return(0,K.w)({name:e,help:"",visible:!0,required:!1,readonly:!1,validate:!0,enable:!0,update:t},u)}function J(e){var u=this;return p.memo(function(n){var a=n.name,r=e.useState(),i=j()(r,2),c=i[0],s=i[1],v=Array.isArray(a)?a:a.split("."),m=["fields"].concat(O()(v)),f=(0,o.getVal)(c,m),d=ce(m,s),h=(0,p.useState)(function(){return z(u.getFieldName(v),f,d)}),b=j()(h,2),C=b[0],Xe=b[1];return(0,p.useEffect)(function(){Xe(z(u.getFieldName(v),f,d))},[f]),Array.isArray(n.children)?n.children.map(function(Ze){return Ze(C)}):n.children(C)},function(t,n){return t.name===n.name})}var oe=l(90393),P=l.n(oe),se=l(7392),D=l.n(se),le=l(11555);function k(e){return e.value}function G(e){var u={};return Object.entries(e).forEach(function(t){var n=j()(t,2),a=n[0],r=n[1];if(typeof a=="string")if(E(r))u[a]=k(r);else if(N(r)){var i=G(r);i&&Object.keys(i).length>0&&(u[a]=i)}else $(r)&&(u[a]=Y(r))}),u}function Y(e){var u=[];return e.forEach(function(t){E(t)?u.push(k(t)):N(t)?u.push(G(t)):$(t)?u.push(Y(t)):u.push(t)}),u}function fe(e,u,t){var n=Object.assign({},t),a=n.onNotMatch,r=a===void 0?function(){}:a;function i(c,s){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];Object.entries(c).forEach(function(m){var f=j()(m,2),d=f[0],h=f[1];if(typeof d=="string"){var b=[].concat(O()(v),[d]);if(d in s){var C=s[d];E(C)?C.value=h:N(C)?(0,S.P)(h)?i(h,C,b):r(b):$(C)?Array.isArray(h)?i(h,C):r(b):s[d]=h}else r(b)}})}i(e,u)}function rt(e,u){var t=new FormData,n=Object.assign({getItemName:function(c){return c.join(".")}},u),a=n.getItemName;function r(i,c){if(c!=null){var s=a?a(i):i.join(".");Array.isArray(c)?c.forEach(function(v,m){r([].concat(_toConsumableArray(i),[String(m)]),v)}):isPlainObject(c)?Object.entries(c).forEach(function(v){var m=_slicedToArray(v,2),f=m[0],d=m[1];r([].concat(_toConsumableArray(i),[f]),d)}):t.append(s,c)}}return r([],e),t}function de(e,u){return function(n,a){var r=Object.assign({validate:!0},a);try{e.enableComputed(!1),fe(n,e.state.fields),e.setState(function(i){i.dirty=!1,i.validate=null})}catch(i){console.error(i)}finally{e.enableComputed(!0),r!=null&&r.validate&&e.computedObjects.runGroup(x)}}}function Q(e,u){return G(e)}function ve(e,u){return function(n){var a=Object.assign({},n);return Q((0,o.getSnap)(e.state).fields)}}function B(e,u){return function(){var t=D()(P()().mark(function n(a){var r;return P()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return r=Object.assign({},u,a),Array.isArray(r.scope)&&r.scope.length>0&&r.scope[0]!==y&&r.scope.unshift(y),c.next=4,e.execute.run(r);case 4:if(!e.execute.error){c.next=8;break}throw new Error(e.execute.error);case 8:return c.abrupt("return",e.execute.result);case 9:case"end":return c.stop()}},n)}));return function(n){return t.apply(this,arguments)}}()}function me(e,u){return(0,p.useCallback)(function(t){var n=Object.assign({},{noReentry:!0,preventDefault:!0},u,t),a=B(e,n);return function(r){a(),r&&n.preventDefault&&typeof r.preventDefault=="function"&&r.preventDefault()}},[e])}function pe(e,u){return(0,p.useCallback)(function(t){var n=(0,o.getValueByPath)(e,[].concat(O()(Array.isArray(u)?u:u.split(".")),["execute"]));n.cancel(),t&&typeof t.preventDefault=="function"&&t.preventDefault()},[])}function he(e,u,t,n){return Object.assign({help:"",title:"",visible:!0,enable:!0},(0,le.C)(e,"execute"),F()(F()({},e.execute),{},{run:u,cancel:t,ref:n}))}var R=p.memo(function(e){return(0,g.jsx)(g.Fragment,{children:typeof e.children=="function"&&e.children(e.actionProps)})},function(e,u){return Object.entries(e.actionProps).every(function(t){var n=j()(t,2),a=n[0],r=n[1];return["children","run","cancel"].includes(a)?!0:r===u.actionProps[a]})});function I(e,u){function t(n){var a=e.useState(),r=j()(a,1),i=r[0],c=n.name;c.includes(".")||(c="actions.".concat(c));var s=(0,o.getValueByPath)(i,c,"."),v=me(s,n),m=pe(i,c),f=(0,p.useRef)(null),d=he(s,v,m,f);if(typeof n.render=="function")return(0,g.jsx)(R,{actionProps:d,children:n.render});if(n.children)return Array.isArray(n.children)?n.children.map(function(h){return(0,g.jsx)(R,{actionProps:d,children:h})}):(0,g.jsx)(R,{actionProps:d,children:n.children})}return p.memo(t,function(n,a){return n.name===a.name})}function M(e,u){return(0,o.computed)(function(){var t=D()(P()().mark(function n(a,r){var i;return P()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=Q(Object.assign({},a)),s.next=3,e(i,r);case 3:return s.abrupt("return",s.sent);case 4:case"end":return s.stop()}},n)}));return function(n,a){return t.apply(this,arguments)}}(),[],u)}function ge(e,u){return M(function(){var t=D()(P()().mark(function n(a,r){var i;return P()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=new FormData,s.next=3,e(i,r);case 3:return s.abrupt("return",s.sent);case 4:case"end":return s.stop()}},n)}));return function(n,a){return t.apply(this,arguments)}}(),u)}function X(e){return function(t,n){var a=(0,p.useRef)(),r=e.useState(),i=j()(r,2),c=i[0],s=i[1],v=(0,p.useState)(function(){return n!=null&&n.name?n==null?void 0:n.name:te()}),m=j()(v,1),f=m[0];return a.current||(s(function(d){f in d.actions||(d.actions[f]={execute:M(t,n)})}),a.current=f),(0,o.getValueByPath)(c,["actions",f]).execute}}var ye=l(54763);function be(e){return e.length>1&&e[0]==y&&e[e.length-1]=="value"}function Ce(e){return(0,o.watch)(function(u,t){var n=t.getSelfValue,a=t.fromPath,r=t.selfPath;if((0,o.isIncludePath)(e||r,a)){var i=n();if(!i)return!0}},function(u){return be(u)},{initial:!1})}var je=l(71698),Ae=l.n(je),Oe=l(41176),Fe=l.n(Oe),Pe=l(77937),Se=l.n(Pe),xe=l(65523),Te=l.n(xe),Ee=l(7122),Ve=l.n(Ee),De=l(19108),Re=l.n(De),Ie=function(e){Te()(t,e);var u=Ve()(t);function t(n){var a;return Se()(this,t),a=u.call(this,n),a.name="ValidationError",a}return Fe()(t)}(Re()(Error));function Z(e){return e.length>1&&e[0]==y&&(e[e.length-1]==="validate"||e.length>=2&&e[e.length-2]=="validate"&&e[e.length-1]=="result")&&!(e.length==2&&e[1]=="validate")&&!(e.length==3&&e[1]=="validate"&&e[2]=="result")}function $e(e){var u=Object.assign({},e),t=u.entry;return(0,o.watch)(function(n,a,r){if((0,o.isIncludePath)(t||r.selfPath,a)){var i=r.cache;if(typeof n=="boolean"){var c=a.join(o.OBJECT_PATH_DELIMITER);n?delete r.cache[c]:r.cache[c]=n}return Object.keys(r.cache).length==0}},function(n){return Z(n)},{initial:!0})}function ut(e,u){var t=typeof e=="function"?e():e;if(!t)throw new ValidationError(typeof u=="function"?u():u)}function Ne(e){return function(){var u=D()(P()().mark(function t(n){var a,r,i,c,s,v;return P()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(Array.isArray(n)&&n.length>0){a=n.join(o.OBJECT_PATH_DELIMITER),r=Ae()(e.computedObjects);try{for(r.s();!(i=r.n()).done;)c=j()(i.value,2),s=c[0],v=c[1],s.startsWith(a)&&v.run()}catch(d){r.e(d)}finally{r.f()}}else e.computedObjects.runGroup(x);case 1:case"end":return f.stop()}},t)}));return function(t){return u.apply(this,arguments)}}()}var Ge={title:"SpeedForm",help:"",tips:"",status:"idle",dirty:Ce(["fields"]),validate:$e({entry:["fields"]}),readonly:!1,enable:!0,visible:!0,actions:{}},Be=l(8033);function Me(e){var u={};return Object.entries(e||{}).forEach(function(t){var n=_slicedToArray(t,2),a=n[0],r=n[1];isFieldValue(r)||isFieldGroup(r)||isFieldList(r)||(u[a]=r)}),u}function Ue(e){return Object.assign({type:"submit",help:"",title:"",dirty:!1,validate:!0,visible:!0,enable:!0,readOnly:!0},Me(e))}var U=null,Le=(0,Be.zo)(function(e,u){var t,n=u.className,a=e.visible;return(0,g.jsx)("input",{className:n+" "+e.className,style:e.style,type:(t=e.type)!==null&&t!==void 0?t:"submit",value:e.title})},{cursor:"pointer",width:"100%",display:"block",boxSizing:"border-box",padding:"8px",borderRadius:"8px",transition:"filter 0.3s","&:hover":{filter:"brightness(1.2)"},"&.speedform-submit":{backgroundColor:"#54b2ff",color:"white",border:"1px solid #1e5786"}});function at(e,u,t){var n=Object.assign({preventDefault:!1},u);function a(r){var i=e.useState(),c=_slicedToArray(i,1),s=c[0],v=r.scope,m=getValueByPath(s,v),f=Ue(m),d=typeof r.render=="function"?1:Array.isArray(r.children)?2:typeof r.children=="function"?3:0;return _jsxs(_Fragment,{children:[_jsx(Le,_objectSpread({visible:d==0},n)),d===1?_jsx(U,{submitProps:f,children:r.render}):d===2?r.children.map(function(h){return _jsx(U,{submitProps:f,children:h})}):_jsx(U,{submitProps:f,children:r.children})]})}return React.memo(a,function(r,i){return r.scope===i.scope})}function We(e,u){var t=I(e,u);return function(n){return(0,g.jsx)(t,F()(F()({},n),{},{name:re,children:function(r){var i=r.title,c=r.visible,s=r.loading,v=r.enable,m=r.run,f=r.cancel,d=r.error,h=r.progress;return(0,g.jsxs)("div",{className:"speedform-submit",children:["\u63D0\u4EA4",(0,g.jsx)("input",{type:"submit"}),(0,g.jsx)("span",{children:s?"\u63D0\u4EA4\u4E2D":"\u5DF2\u63D0\u4EA4"})]})}}))}}function He(e,u){var t=I(e,u);return function(n){return(0,g.jsx)(t,{name:"ffff",children:function(r){return(0,g.jsx)("input",{type:"submit",value:n.title})}})}}function we(e,u,t,n){e.length>=2&&e[0]==y&&e[e.length-1]==x&&(t.scope||(t.scope="value"),t.depends||(t.depends=[]),t.depends.push([].concat(O()(e.slice(0,-1)),["value"])),t.initial=null,t.group=x,t.enable=!0)}function Ke(e){(0,ye.w)(e,Ge)}function ze(e,u,t){e.length>1&&e[e.length-1]=="execute"&&(t.immediate=!1,t.scope?Array.isArray(t.scope)&&t.scope.length>0&&t.scope[0]!=y&&t.scope.unshift(y):t.scope=[y],t.noReentry=!0)}function Je(e,u,t){e.length>0&&e[0]==y&&t.depends&&t.depends.forEach(function(n,a){Array.isArray(n)&&n.length>0&&n[0]!=y?t.depends[a]=[y].concat(O()(n)):typeof n=="string"&&!n.startsWith("".concat(y,"."))&&(t.depends[a]="".concat(y,".").concat(n))})}function ke(e){return function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;e.enableComputed(u)}}function q(e,u){var t=(0,K.w)({getFieldName:function(r){return r.length>0?r[r.length-1]==="value"?r.slice(0,-1).join("."):r.join("."):""},singleton:!0,validAt:"once"},u);Ke(e);var n=(0,o.createStore)({state:e},{debug:t.debug,singleton:t.singleton,computedThis:function(){return o.ComputedScopeRef.Root},computedScope:function(){return[y]},onCreateComputed:function(r,i,c){we(r,i,c,t),Je(r,i,c),ze(r,i,c)},onComputedContext:function(r,i){var c=i.computedType,s=i.contextType,v=i.valuePath;if(c==="Computed"&&s=="scope"&&v.length>0&&v[0]==y)return r.fields},onCreateComputedObject:function(r,i){Z(r)&&(i.options.enable=t.validAt==="once")}});return{store:n,getAction:B,Form:Ye.call(t,n),Field:w.call(t,n),Group:J.call(t,n),Action:I(n,t),Submit:We(n,t),Reset:He(n,t),useAction:X(n),fields:H(function(){return n.state.fields}),actions:H(function(){return n.state.actions}),state:n.state,useState:n.useState,freeze:ke(n),load:de(n,t),getValues:ve(n,t),computedObjects:n.computedObjects,watchObjects:n.watchObjects,validate:Ne(n)}}function Ye(e){var u=this;return p.forwardRef(function(t,n){var a=t.children,r=(0,p.useCallback)(function(c){u.validAt==="submit"&&e.computedObjects.runGroup(x)},[]),i=(0,p.useCallback)(function(c){},[]);return(0,g.jsx)("form",F()(F()({ref:n,className:"speedform"},t),{},{onSubmit:r,onReset:i,children:a}))})}function Qe(e,u){var t=(0,p.useRef)();return t.current==null&&(t.current=q(e(),u)),t.current}},91492:function(L){function A(l){var T=new Error("Cannot find module '"+l+"'");throw T.code="MODULE_NOT_FOUND",T}A.keys=function(){return[]},A.resolve=A,A.id=91492,L.exports=A}}]);
