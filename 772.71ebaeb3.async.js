"use strict";(self.webpackChunkspeedform_docs=self.webpackChunkspeedform_docs||[]).push([[772],{65772:function(Qe,I,l){l.r(I),l.d(I,{ActionChildren:function(){return D},FieldChildren:function(){return V},ValidationError:function(){return Ve},action:function(){return G},createActionComponent:function(){return J},createFieldComponent:function(){return L},createFieldGroupComponent:function(){return H},createForm:function(){return Z},createUseAction:function(){return Q},getAction:function(){return $},submit:function(){return ge},useForm:function(){return We}});var k=l(79664),F=l.n(k),q=l(70125),b=l.n(q),_=l(39114),C=l.n(_),f=l(70079),Xe=l(26851),S=l(13192);function Ze(e){var r=_typeof(e);return e==null||r=="boolean"||r=="number"||r=="string"||r==null}function B(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=0,t,u=!0,a=function i(){if(t==null){u=!0,clearTimeout(n),n=0;return}try{var o=t;t=void 0,e.apply(void 0,F()(o)),n=setTimeout(function(){return i()},r)}finally{}};return function(){for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];if(r==0)return e.apply(void 0,o);t=o,(u||n==0)&&(u=!1,a())}}function ke(e,r){var n={};for(var t in e)e[t]!==r[t]&&(n[t]=r[t]);return n}function ee(){return Math.random().toString(36).substring(2)}function M(e){return new Proxy({},{get:function(n,t,u){return e()[t]}})}function ne(e){return(0,S.P)(e)&&"execute"in e&&(0,S.P)(e.execute)&&"loading"in e.execute}function P(e){return(0,S.P)(e)&&"value"in e}function x(e){return Array.isArray(e)}function E(e){return(0,S.P)(e)&&!P(e)&&!ne(e)}function qe(){return!1}var A="fields",_e="actions",U="validate",y=l(59664),h=l(35250);function te(e,r,n,t){return Object.assign({name:e,help:"",initial:void 0,oldValue:void 0,visible:!0,required:!1,readonly:!1,validate:null,enable:!0,placeholder:""},C()(C()({},r),{},{sync:n,update:t}))}function re(e,r){var n=(0,f.useRef)(null);return(0,f.useCallback)(function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(n.current==null){var u=e.sync(r);n.current=t==0?u:B(u,t)}return n.current},[])}function ue(e,r){var n=(0,f.useRef)(null),t=(0,f.useState)(0),u=b()(t,2),a=u[0],i=u[1];return(0,f.useCallback)(function(o,c){var s=Object.assign({debounce:0},c),d=s.debounce;if(n.current==null||a!==d){a!==d&&d>0&&i(d);var v=function(g){return function(p){r(typeof g=="function"?function(j){return g.call(j,j.fields)}:function(j){return(0,y.setVal)(j,e,g)}),typeof p.preventDefault=="function"&&p.preventDefault()}};n.current=d>0?v:B(v,d)}return n.current(o)},[])}var V=f.memo(function(e){return(0,h.jsx)(h.Fragment,{children:typeof e.children=="function"&&e.children(e.fieldProps)})},function(e,r){return Object.entries(e.fieldProps).every(function(n){var t=b()(n,2),u=t[0],a=t[1];return["children","sync","update"].includes(u)?!0:a===r.fieldProps[u]})});function L(e){var r=this;return f.memo(function(n){var t=n.name,u=Array.isArray(t)?t:t.split("."),a=[A].concat(F()(u)),i=[A].concat(F()(u));u.push("value"),i.push("value");var o=e.useState(function(p){return(0,y.getVal)(p,a)}),c=b()(o,2),s=c[0],d=c[1],v=ue(i,d),m=re(e,i),g=te(r.getFieldName(u),s,m,v);return n.render?(0,h.jsx)(V,{fieldProps:g,children:n.render}):Array.isArray(n.children)?n.children.map(function(p){return(0,h.jsx)(V,{fieldProps:g,children:p})}):(0,h.jsx)(V,{fieldProps:g,children:n.children})},function(n,t){return n.name===t.name})}var ae=l(90393),O=l.n(ae),ie=l(7392),R=l.n(ie),K=l(23893);function ce(e,r){return(0,f.useCallback)(function(n){r(function(t){n.call(t,(0,y.getVal)(t,e))})},[])}function z(e,r,n){return(0,K.w)({name:e,help:"",visible:!0,required:!1,readonly:!1,validate:!0,enable:!0,update:n},r)}function H(e){var r=this;return f.memo(function(t){var u=t.name,a=e.useState(),i=b()(a,2),o=i[0],c=i[1],s=Array.isArray(u)?u:u.split("."),d=["fields"].concat(F()(s)),v=(0,y.getVal)(o,d),m=ce(d,c),g=(0,f.useState)(function(){return z(r.getFieldName(s),v,m)}),p=b()(g,2),j=p[0],Ye=p[1];return(0,f.useEffect)(function(){Ye(z(r.getFieldName(s),v,m))},[v]),Array.isArray(t.children)?t.children.map(function(Je){return Je(j)}):t.children(j)},function(n,t){return n.name===t.name})}var oe=l(76120);function w(e){return e.value}function T(e){var r={};return Object.entries(e).forEach(function(n){var t=b()(n,2),u=t[0],a=t[1];if(typeof u=="string")if(P(a))r[u]=w(a);else if(E(a)){var i=T(a);i&&Object.keys(i).length>0&&(r[u]=i)}else x(a)&&(r[u]=W(a))}),r}function W(e){var r=[];return e.forEach(function(n){P(n)?r.push(w(n)):E(n)?r.push(T(n)):x(n)?r.push(W(n)):r.push(n)}),r}function le(e,r,n){var t=Object.assign({},n),u=t.onNotMatch,a=u===void 0?function(){}:u;function i(o,c){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];Object.entries(o).forEach(function(d){var v=b()(d,2),m=v[0],g=v[1];if(typeof m=="string"){var p=[].concat(F()(s),[m]);if(m in c){var j=c[m];P(j)?j.value=g:E(j)?(0,S.P)(g)?i(g,j,p):a(p):x(j)?Array.isArray(g)?i(g,j):a(p):c[m]=g}else a(p)}})}i(e,r)}function en(e,r){var n=new FormData,t=Object.assign({getItemName:function(o){return o.join(".")}},r),u=t.getItemName;function a(i,o){if(o!=null){var c=u?u(i):i.join(".");Array.isArray(o)?o.forEach(function(s,d){a([].concat(_toConsumableArray(i),[String(d)]),s)}):isPlainObject(o)?Object.entries(o).forEach(function(s){var d=_slicedToArray(s,2),v=d[0],m=d[1];a([].concat(_toConsumableArray(i),[v]),m)}):n.append(c,o)}}return a([],e),n}function se(e,r){return function(t,u){var a=Object.assign({validate:!0},u);try{e.setEnableMutate(!1),le(t,e.state.fields),e.setState(function(i){i.dirty=!1,i.validate=null})}catch(i){console.error(i)}finally{e.setEnableMutate(!0),a!=null&&a.validate&&e.computedObjects.runGroup(U)}}}function Y(e,r){return T(e)}function fe(e,r){return function(t){var u=Object.assign({},t);return Y((0,y.getSnap)(e.state).fields)}}function $(e,r){return function(){var n=R()(O()().mark(function t(u){var a;return O()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a=Object.assign({},r,u),o.next=3,e.execute.run(a);case 3:if(!e.execute.error){o.next=7;break}throw new Error(e.execute.error);case 7:return o.abrupt("return",e.execute.result);case 8:case"end":return o.stop()}},t)}));return function(t){return n.apply(this,arguments)}}()}function de(e,r){return(0,f.useCallback)(function(n){var t=Object.assign({},{noReentry:!0,preventDefault:!0},r,n),u=$(e,t);return function(a){u(),a&&t.preventDefault&&typeof a.preventDefault=="function"&&a.preventDefault()}},[e])}function ve(e,r){return(0,f.useCallback)(function(n){var t=(0,y.getValueByPath)(e,[].concat(F()(Array.isArray(r)?r:r.split(".")),["execute"]));t.cancel(),n&&typeof n.preventDefault=="function"&&n.preventDefault()},[])}function me(e,r,n,t){return Object.assign({help:"",title:"",visible:!0,enable:!0},(0,oe.C)(e,"execute"),C()(C()({},e.execute),{},{run:r,cancel:n,ref:t}))}var D=f.memo(function(e){return(0,h.jsx)(h.Fragment,{children:typeof e.children=="function"&&e.children(e.actionProps)})},function(e,r){return Object.entries(e.actionProps).every(function(n){var t=b()(n,2),u=t[0],a=t[1];return["children","run","cancel"].includes(u)?!0:a===r.actionProps[u]})});function J(e,r,n){function t(u){var a=e.useState(),i=b()(a,1),o=i[0],c=u.name;c.includes(".")||(c="actions.".concat(c));var s=(0,y.getValueByPath)(o,c,"."),d=de(s,r),v=ve(o,c),m=(0,f.useRef)(null),g=me(s,d,v,m);if(typeof u.render=="function")return(0,h.jsx)(D,{actionProps:g,children:u.render});if(u.children)return Array.isArray(u.children)?u.children.map(function(p){return(0,h.jsx)(D,{actionProps:g,children:p})}):(0,h.jsx)(D,{actionProps:g,children:u.children})}return f.memo(t,function(u,a){return u.name===a.name})}function G(e,r){return(0,y.computed)(function(){var n=R()(O()().mark(function t(u,a){var i;return O()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return i=Y((0,y.getSnap)(u,!1).fields),c.next=3,e(i,a);case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},t)}));return function(t,u){return n.apply(this,arguments)}}(),[],r)}function ge(e,r){return G(function(){var n=R()(O()().mark(function t(u,a){var i;return O()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return i=new FormData,c.next=3,e(i,a);case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},t)}));return function(t,u){return n.apply(this,arguments)}}(),r)}function Q(e){return function(n,t){var u=(0,f.useRef)(),a=e.useState(),i=b()(a,2),o=i[0],c=i[1],s=(0,f.useState)(function(){return t!=null&&t.name?t==null?void 0:t.name:ee()}),d=b()(s,1),v=d[0];return u.current||(c(function(m){v in m.actions||(m.actions[v]={execute:G(n,t)})}),u.current=v),(0,y.getValueByPath)(o,["actions",v]).execute}}var he=l(83443);function ye(e){return e.length>1&&e[0]==A&&e[e.length-1]=="value"}function pe(e){return(0,y.watch)(function(r,n){var t=n.getSelfValue,u=n.triggerPath,a=n.selfPath;if((0,y.isIncludePath)(e||a,u)){var i=t();if(!i)return!0}},function(r){return ye(r)},{initial:!1})}var be=l(41176),je=l.n(be),Ae=l(77937),Ce=l.n(Ae),Fe=l(65523),Oe=l.n(Fe),Se=l(7122),Pe=l.n(Se),xe=l(19108),Ee=l.n(xe),Ve=function(e){Oe()(n,e);var r=Pe()(n);function n(t){var u;return Ce()(this,n),u=r.call(this,t),u.name="ValidationError",u}return je()(n)}(Ee()(Error));function Re(e){return e.length>1&&e[0]==A&&(e[e.length-1]==="validate"||e.length>=2&&e[e.length-2]=="validate"&&e[e.length-1]=="result")&&!(e.length==2&&e[1]=="validate")&&!(e.length==3&&e[1]=="validate"&&e[2]=="result")}function De(e){var r=Object.assign({},e),n=r.entry;return(0,y.watch)(function(t,u){var a=u.triggerPath,i=u.selfPath,o=u.getCache;if((0,y.isIncludePath)(n||i,a)){var c=o();if(typeof t=="boolean"){var s=a.join(y.OBJECT_PATH_DELIMITER);t?delete c[s]:c[s]=t}return Object.keys(c).length==0}},function(t){return Re(t)},{initial:!0})}function nn(e,r){var n=typeof e=="function"?e():e;if(!n)throw new ValidationError(typeof r=="function"?r():r)}var Te={title:"SpeedForm",help:"",tips:"",status:"idle",dirty:pe(["fields"]),validate:De({entry:["fields"]}),readonly:!1,enable:!0,visible:!0,actions:{}},$e=l(83038);function Ge(e){var r={};return Object.entries(e||{}).forEach(function(n){var t=b()(n,2),u=t[0],a=t[1];P(a)||E(a)||x(a)||(r[u]=a)}),r}function Ne(e){return Object.assign({type:"submit",help:"",title:"",dirty:!1,validate:!0,visible:!0,enable:!0,readOnly:!0},Ge(e))}var N=f.memo(function(e){return(0,h.jsx)(h.Fragment,{children:typeof e.children=="function"&&e.children(e.submitProps)})},function(e,r){return Object.entries(e.submitProps).every(function(n){var t=b()(n,2),u=t[0],a=t[1];return["children","render"].includes(u)?!0:a===r.submitProps[u]})}),Ie=(0,$e.zo)(function(e,r){var n,t,u=r.className,a=e.visible;return(0,h.jsx)("input",{className:u,style:Object.assign({display:a?"inline-block":"none"},e.style),type:(n=e.type)!==null&&n!==void 0?n:"submit",value:(t=e.title)!==null&&t!==void 0?t:"\u63D0\u4EA4"})},{minWidth:"80px",cursor:"pointer",boxSizing:"border-box",margin:"2px",transition:"filter 0.3s","&:hover":{filter:"brightness(1.2)"}});function X(e,r,n){var t=Object.assign({preventDefault:!1},r);function u(a){var i=e.useState(),o=b()(i,1),c=o[0],s=a.scope,d=(0,y.getValueByPath)(c,s),v=Ne(d),m=typeof a.render=="function"?1:Array.isArray(a.children)?2:typeof a.children=="function"?3:0;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Ie,C()({visible:m==0},t)),m===1?(0,h.jsx)(N,{submitProps:v,children:a.render}):m===2?a.children.map(function(g){return(0,h.jsx)(N,{submitProps:v,children:g})}):(0,h.jsx)(N,{submitProps:v,children:a.children})]})}return f.memo(u,function(a,i){return a.name===i.name})}function Be(e,r,n){return X(e,C()({type:"submit",title:"\u63D0\u4EA4",style:{borderRadius:"4px",padding:"8px",background:"#1c8ceb",border:"1px solid #1c8ceb",color:"#fff"}},r),n)}function Me(e,r,n){return X(e,C()({type:"reset",title:"\u91CD\u7F6E",style:{borderRadius:"4px",padding:"8px",background:"#eee",border:"1px solid #bbb"}},r),n)}function Ue(e,r,n){e.length>=2&&e[0]==A&&e[e.length-1]=="validate"&&(n.scope||(n.scope="value"),n.depends||(n.depends=[]),n.depends.push([].concat(F()(e.slice(0,-1)),["value"])),n.initial=null,n.group="validate")}function Le(e){(0,he.w)(e,Te)}function Ke(e,r,n){e.length>1&&e[e.length-1]=="execute"&&(n.immediate=!1,n.scope=[A],n.noReentry=!0)}function ze(e,r,n){e.length>0&&e[0]==A&&n.depends&&n.depends.forEach(function(t,u){Array.isArray(t)&&t.length>0&&t[0]!=A?n.depends[u]=[A].concat(F()(t)):typeof t=="string"&&!t.startsWith("".concat(A,"."))&&(n.depends[u]="".concat(A,".").concat(t))})}function He(e){return function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;e.setEnableMutate(r)}}function Z(e,r){var n=(0,K.w)({getFieldName:function(a){return a.length>0?a[a.length-1]==="value"?a.slice(0,-1).join("."):a.join("."):""},singleton:!0},r);Le(e);var t=(0,y.createStore)({state:e},{debug:n.debug,singleton:n.singleton,computedThis:function(){return y.ComputedScopeRef.Root},computedScope:function(){return[A]},onCreateComputed:function(a,i,o){Ue(a,i,o),ze(a,i,o),Ke(a,i,o)},onComputedContext:function(a,i){var o=i.computedType,c=i.contextType,s=i.valuePath;if(o==="Computed"&&c=="scope"&&s.length>0&&s[0]==A)return a.fields}});return{Form:we.call(n,t),Field:L.call(n,t),Group:H.call(n,t),Action:J(t,{},n),Submit:Be(t,{},n),Reset:Me(t,{},n),getAction:$,useAction:Q(t),fields:M(function(){return t.state.fields}),actions:M(function(){return t.state.actions}),state:t.state,useState:t.useState,freeze:He(t),load:se(t,n),getValues:fe(t,n),computedObjects:t.computedObjects,watchObjects:t.watchObjects,store:t,validate:function(){var u=R()(O()().mark(function i(){return O()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",t.computedObjects.runGroup(U));case 1:case"end":return c.stop()}},i)}));function a(){return u.apply(this,arguments)}return a}()}}function we(e){return f.forwardRef(function(r,n){var t=r.children,u=(0,f.useCallback)(function(i){},[]),a=(0,f.useCallback)(function(i){},[]);return(0,h.jsx)("form",C()(C()({ref:n,className:"speedform-form"},r),{},{onSubmit:u,onReset:a,children:t}))})}function We(e,r){var n=(0,f.useRef)();return n.current==null&&(n.current=Z(e(),r)),n.current}}}]);
