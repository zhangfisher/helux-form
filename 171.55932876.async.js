"use strict";(self.webpackChunkspeedform_docs=self.webpackChunkspeedform_docs||[]).push([[171],{43171:function(an,M,f){f.r(M),f.d(M,{$:function(){return l.$},ActionChildren:function(){return V},ComputedObjects:function(){return l.ComputedObjects},ComputedScopeRef:function(){return l.ComputedScopeRef},FieldChildren:function(){return S},OBJECT_PATH_DELIMITER:function(){return l.OBJECT_PATH_DELIMITER},SKIP_COMPUTED:function(){return l.SKIP_COMPUTED},ValidationError:function(){return Ie},WatchObject:function(){return l.WatchObject},WatchObjects:function(){return l.WatchObjects},action:function(){return G},asyncComputedObject:function(){return l.asyncComputedObject},computed:function(){return l.computed},createActionComponent:function(){return D},createAsyncComputedMutate:function(){return l.createAsyncComputedMutate},createComputedMutate:function(){return l.createComputedMutate},createFieldComponent:function(){return W},createFieldGroupComponent:function(){return z},createForm:function(){return en},createObject:function(){return l.createObject},createStore:function(){return l.createStore},createUseAction:function(){return Y},createUseWatch:function(){return l.createUseWatch},createWatch:function(){return l.createWatch},defaultFormProps:function(){return X},getAction:function(){return U},getSnap:function(){return l.getSnap},getVal:function(){return l.getVal},getValueByPath:function(){return l.getValueByPath},installComputed:function(){return l.installComputed},installWatch:function(){return l.installWatch},isIncludePath:function(){return l.isIncludePath},isSkipComputed:function(){return l.isSkipComputed},markRaw:function(){return l.markRaw},setAsyncComputedObject:function(){return l.setAsyncComputedObject},setVal:function(){return l.setVal},skipComputed:function(){return l.skipComputed},submit:function(){return je},useLatest:function(){return Z},useStore:function(){return l.useStore},useUnmount:function(){return tn},useUnmountedRef:function(){return rn},watch:function(){return l.watch}});var q=f(79664),C=f.n(q),_=f(70125),A=f.n(_),ee=f(39114),O=f.n(ee),v=f(70079),ne=f(26851),te=f.n(ne),P=f(59166);function cn(e){var r=_typeof(e);return e==null||r=="boolean"||r=="number"||r=="string"||r==null}function E(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=0,t,u=!0,a=function i(){if(t==null){u=!0,clearTimeout(n),n=0;return}try{var c=t;t=void 0,e.apply(void 0,C()(c)),n=setTimeout(function(){return i()},r)}finally{}};return function(){for(var i=arguments.length,c=new Array(i),o=0;o<i;o++)c[o]=arguments[o];if(r==0)return e.apply(void 0,c);t=c,(u||n==0)&&(u=!1,a())}}function on(e,r){var n={};for(var t in e)e[t]!==r[t]&&(n[t]=r[t]);return n}function re(){return Math.random().toString(36).substring(2)}function L(e){return new Proxy({},{get:function(n,t,u){return e()[t]}})}function ue(e){return(0,P.P)(e)&&"execute"in e&&(0,P.P)(e.execute)&&"loading"in e.execute}function R(e){return(0,P.P)(e)&&"value"in e}function $(e){return Array.isArray(e)}function I(e){return(0,P.P)(e)&&!R(e)&&!ue(e)}function ae(){return!1}var j="fields",ln="actions",x="validate",ie="$submit",l=f(43200),b=f(35250);function ce(e,r,n,t){return Object.assign({name:e,help:"",initial:void 0,oldValue:void 0,visible:!0,required:!1,readonly:!1,validate:null,enable:!0,placeholder:""},O()(O()({},r),{},{sync:n,update:t}))}function oe(e,r){var n=(0,v.useRef)(null);return(0,v.useCallback)(function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(n.current==null){var u=e.sync(r);n.current=t==0?u:E(u,t)}return n.current},[])}function le(e,r){var n=(0,v.useRef)(null),t=(0,v.useState)(0),u=A()(t,2),a=u[0],i=u[1];return(0,v.useCallback)(function(c,o){var p=Object.assign({debounce:0},o),s=p.debounce;if(n.current==null||a!==s){a!==s&&s>0&&i(s);var d=function(m){return function(y){r(typeof m=="function"?function(g){return m.call(g,g.fields)}:function(g){return(0,l.setVal)(g,e,m)}),typeof y.preventDefault=="function"&&y.preventDefault()}};n.current=s>0?d:E(d,s)}return n.current(c)},[])}var S=v.memo(function(e){return(0,b.jsx)(b.Fragment,{children:typeof e.children=="function"&&e.children(e.fieldProps)})},function(e,r){return Object.entries(e.fieldProps).every(function(n){var t=A()(n,2),u=t[0],a=t[1];return["children","sync","update"].includes(u)?!0:a===r.fieldProps[u]})});function W(e,r){return v.memo(function(n){var t=n.name,u=Array.isArray(t)?t:t.split("."),a=[j].concat(C()(u)),i=[j].concat(C()(u));u.push("value"),i.push("value");var c=e.useState(function(y){return(0,l.getVal)(y,a)}),o=A()(c,2),p=o[0],s=o[1],d=le(i,s),h=oe(e,i),m=ce(r.getFieldName(u),p,h,d);return n.render?(0,b.jsx)(S,{fieldProps:m,children:n.render}):Array.isArray(n.children)?n.children.map(function(y,g){return(0,b.jsx)(S,{fieldProps:m,children:y},g)}):(0,b.jsx)(S,{fieldProps:m,children:n.children})},function(n,t){return n.name===t.name})}var H=f(58048);function se(e,r){return(0,v.useCallback)(function(n){r(function(t){n.call(t,(0,l.getVal)(t,e))})},[])}function K(e,r,n){return(0,H.w)({name:e,help:"",visible:!0,required:!1,readonly:!1,validate:!0,enable:!0,update:n},r)}function z(e,r){return v.memo(function(n){var t=n.name,u=e.useState(),a=A()(u,2),i=a[0],c=a[1],o=Array.isArray(t)?t:t.split("."),p=["fields"].concat(C()(o)),s=(0,l.getVal)(i,p),d=se(p,c),h=(0,v.useState)(function(){return K(r.getFieldName(o),s,d)}),m=A()(h,2),y=m[0],g=m[1];return(0,v.useEffect)(function(){g(K(r.getFieldName(o),s,d))},[s]),Array.isArray(n.children)?n.children.map(function(un){return un(y)}):n.children(y)},function(n,t){return n.name===t.name})}var fe=f(90393),F=f.n(fe),de=f(7392),T=f.n(de),ve=f(6597);function J(e){return e.value}function N(e){var r={};return Object.entries(e).forEach(function(n){var t=A()(n,2),u=t[0],a=t[1];if(typeof u=="string")if(R(a))r[u]=J(a);else if(I(a)){var i=N(a);i&&Object.keys(i).length>0&&(r[u]=i)}else $(a)&&(r[u]=w(a))}),r}function w(e){var r=[];return e.forEach(function(n){R(n)?r.push(J(n)):I(n)?r.push(N(n)):$(n)?r.push(w(n)):r.push(n)}),r}function me(e,r,n){var t=Object.assign({},n),u=t.onNotMatch,a=u===void 0?function(){}:u;function i(c,o){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];Object.entries(c).forEach(function(s){var d=A()(s,2),h=d[0],m=d[1];if(typeof h=="string"){var y=[].concat(C()(p),[h]);if(h in o){var g=o[h];R(g)?g.value=m:I(g)?(0,P.P)(m)?i(m,g,y):a(y):$(g)?Array.isArray(m)?i(m,g):a(y):o[h]=m}else a(y)}})}i(e,r)}function sn(e,r){var n=new FormData,t=Object.assign({getItemName:function(c){return c.join(".")}},r),u=t.getItemName;function a(i,c){if(c!=null){var o=u?u(i):i.join(".");Array.isArray(c)?c.forEach(function(p,s){a([].concat(_toConsumableArray(i),[String(s)]),p)}):isPlainObject(c)?Object.entries(c).forEach(function(p){var s=_slicedToArray(p,2),d=s[0],h=s[1];a([].concat(_toConsumableArray(i),[d]),h)}):n.append(o,c)}}return a([],e),n}function pe(e,r){return function(t,u){var a=Object.assign({validate:!0},u);try{e.enableComputed(!1),me(t,e.state.fields),e.setState(function(i){i.dirty=!1,i.validate=null})}catch(i){console.error(i)}finally{e.enableComputed(!0),a!=null&&a.validate&&e.computedObjects.runGroup(x)}}}function k(e,r){return N(e)}function he(e,r){return function(t){var u=Object.assign({},t);return k((0,l.getSnap)(e.state).fields)}}function U(e,r){return function(){var n=T()(F()().mark(function t(u){var a;return F()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=Object.assign({},r,u),Array.isArray(a.scope)&&a.scope.length>0&&a.scope[0]!==j&&a.scope.unshift(j),c.next=4,e.execute.run(a);case 4:if(!e.execute.error){c.next=8;break}throw new Error(e.execute.error);case 8:return c.abrupt("return",e.execute.result);case 9:case"end":return c.stop()}},t)}));return function(t){return n.apply(this,arguments)}}()}function ye(e,r){return(0,v.useCallback)(function(n){var t=Object.assign({},{noReentry:!0,preventDefault:!0},r,n),u=U(e,t);return function(a){u(),a&&t.preventDefault&&typeof a.preventDefault=="function"&&a.preventDefault()}},[e])}function ge(e,r){return(0,v.useCallback)(function(n){var t=(0,l.getValueByPath)(e,[].concat(C()(Array.isArray(r)?r:r.split(".")),["execute"]));t.cancel(),n&&typeof n.preventDefault=="function"&&n.preventDefault()},[])}function be(e,r,n,t){return Object.assign({help:"",title:"",visible:!0,enable:!0},(0,ve.C)(e,"execute"),O()(O()({},e.execute),{},{run:r,cancel:n,ref:t}))}var V=v.memo(function(e){return(0,b.jsx)(b.Fragment,{children:typeof e.children=="function"&&e.children(e.actionProps)})},function(e,r){return Object.entries(e.actionProps).every(function(n){var t=A()(n,2),u=t[0],a=t[1];return["children","run","cancel"].includes(u)?!0:a===r.actionProps[u]})});function D(e,r){function n(t){var u=e.useState(),a=A()(u,1),i=a[0],c=t.name;c.includes(".")||(c="actions.".concat(c));var o=(0,l.getValueByPath)(i,c,"."),p=ye(o,t),s=ge(i,c),d=(0,v.useRef)(null),h=be(o,p,s,d);if(typeof t.render=="function")return(0,b.jsx)(V,{actionProps:h,children:t.render});if(t.children)return Array.isArray(t.children)?t.children.map(function(m,y){return(0,b.jsx)(V,{actionProps:h,children:m},y)}):(0,b.jsx)(V,{actionProps:h,children:t.children})}return v.memo(n,function(t,u){return t.name===u.name})}function G(e,r){return(0,l.computed)(function(){var n=T()(F()().mark(function t(u,a){var i;return F()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i=k(Object.assign({},u)),o.next=3,e(i,a);case 3:return o.abrupt("return",o.sent);case 4:case"end":return o.stop()}},t)}));return function(t,u){return n.apply(this,arguments)}}(),[],r)}function je(e,r){return G(function(){var n=T()(F()().mark(function t(u,a){var i;return F()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i=new FormData,o.next=3,e(i,a);case 3:return o.abrupt("return",o.sent);case 4:case"end":return o.stop()}},t)}));return function(t,u){return n.apply(this,arguments)}}(),r)}function Y(e){return function(n,t){var u=(0,v.useRef)(),a=e.useState(),i=A()(a,2),c=i[0],o=i[1],p=(0,v.useState)(function(){return t!=null&&t.name?t==null?void 0:t.name:re()}),s=A()(p,1),d=s[0];return u.current||(d in c.actions||o(function(h){h.actions[d]={execute:G(n,t)}}),u.current=d),(0,l.getValueByPath)(c,["actions",d]).execute}}var Ae=f(20842),Ce=f(71698),Oe=f.n(Ce),Fe=f(41176),Se=f.n(Fe),Pe=f(77937),xe=f.n(Pe),Ee=f(65523),Re=f.n(Ee),Te=f(7122),Ve=f.n(Te),De=f(19108),$e=f.n(De),Ie=function(e){Re()(n,e);var r=Ve()(n);function n(t){var u;return xe()(this,n),u=r.call(this,t),u.name="ValidationError",u}return Se()(n)}($e()(Error));function Q(e){return e.length>1&&e[0]==j&&(e[e.length-1]==="validate"||e.length>=2&&e[e.length-2]=="validate"&&e[e.length-1]=="result")&&!(e.length==2&&e[1]=="validate")&&!(e.length==3&&e[1]=="validate"&&e[2]=="result")}function Ne(e){var r=Object.assign({},e),n=r.entry;return(0,l.watch)(function(t,u,a){if((0,l.isIncludePath)(n||a.path,t)){if(typeof u=="boolean"){var i=t.join(l.OBJECT_PATH_DELIMITER);u?delete a.cache[i]:a.cache[i]=u}return Object.keys(a.cache).length==0}},function(t){return Q(t)},{initial:!0})}function fn(e,r){var n=typeof e=="function"?e():e;if(!n)throw new ValidationError(typeof r=="function"?r():r)}function Ue(e){return function(){var r=T()(F()().mark(function n(t){var u,a,i,c,o,p;return F()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(Array.isArray(t)&&t.length>0){u=t.join(l.OBJECT_PATH_DELIMITER),a=Oe()(e.computedObjects);try{for(a.s();!(i=a.n()).done;)c=A()(i.value,2),o=c[0],p=c[1],o.startsWith(u)&&p.run()}catch(h){a.e(h)}finally{a.f()}}else e.computedObjects.runGroup(x);case 1:case"end":return d.stop()}},n)}));return function(n){return r.apply(this,arguments)}}()}var Ge=f(8033);function Be(e){var r={};return Object.entries(e||{}).forEach(function(n){var t=_slicedToArray(n,2),u=t[0],a=t[1];isFieldValue(a)||isFieldGroup(a)||isFieldList(a)||(r[u]=a)}),r}function Me(e){return Object.assign({type:"submit",help:"",title:"",dirty:!1,validate:!0,visible:!0,enable:!0,readOnly:!0},Be(e))}var B=null,Le=(0,Ge.zo)(function(e,r){var n,t=r.className,u=e.visible;return(0,b.jsx)("input",{className:t+" "+e.className,style:e.style,type:(n=e.type)!==null&&n!==void 0?n:"submit",value:e.title})},{cursor:"pointer",width:"100%",display:"block",boxSizing:"border-box",padding:"8px",borderRadius:"8px",transition:"filter 0.3s","&:hover":{filter:"brightness(1.2)"},"&.speedform-submit":{backgroundColor:"#54b2ff",color:"white",border:"1px solid #1e5786"}});function dn(e,r,n){var t=Object.assign({preventDefault:!1},r);function u(a){var i=e.useState(),c=_slicedToArray(i,1),o=c[0],p=a.scope,s=getValueByPath(o,p),d=Me(s),h=typeof a.render=="function"?1:Array.isArray(a.children)?2:typeof a.children=="function"?3:0;return _jsxs(_Fragment,{children:[_jsx(Le,_objectSpread({visible:h==0},t)),h===1?_jsx(B,{submitProps:d,children:a.render}):h===2?a.children.map(function(m,y){return _jsx(B,{submitProps:d,children:m},y)}):_jsx(B,{submitProps:d,children:a.children})]})}return React.memo(u,function(a,i){return a.scope===i.scope})}function We(e,r){var n=D(e,r);return function(t){return(0,b.jsx)(n,O()(O()({},t),{},{name:ie,children:function(a){var i=a.title,c=a.visible,o=a.loading,p=a.enable,s=a.run,d=a.cancel,h=a.error,m=a.progress;return(0,b.jsxs)("div",{className:"speedform-submit",children:["\u63D0\u4EA4",(0,b.jsx)("input",{type:"submit"}),(0,b.jsx)("span",{children:o?"\u63D0\u4EA4\u4E2D":"\u5DF2\u63D0\u4EA4"})]})}}))}}function He(e,r){var n=D(e,r);return function(t){return(0,b.jsx)(n,{name:"ffff",children:function(a){return(0,b.jsx)("input",{type:"submit",value:t.title})}})}}function Ke(e){return e.length>1&&e[0]==j&&e[e.length-1]=="value"}function ze(e){return(0,l.watch)(function(r,n,t){if((0,l.isIncludePath)(e||t.path,r)&&!t.value)return!0},function(r){return Ke(r)},{initial:!1})}function Je(e,r,n,t){return Object.assign({name:e,help:"",initial:void 0,oldValue:void 0,visible:!0,required:!1,readonly:!1,validate:null,enable:!0,placeholder:""},O()(O()({},r),{},{sync:n,update:t}))}function we(e,r){var n=(0,v.useRef)(null);return(0,v.useCallback)(function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(n.current==null){var u=e.sync(r);n.current=t==0?u:E(u,t)}return n.current},[])}function ke(e,r){var n=(0,v.useRef)(null),t=(0,v.useState)(0),u=A()(t,2),a=u[0],i=u[1];return(0,v.useCallback)(function(c,o){var p=Object.assign({debounce:0},o),s=p.debounce;if(n.current==null||a!==s){a!==s&&s>0&&i(s);var d=function(m){return function(y){r(typeof m=="function"?function(g){return m.call(g,g.fields)}:function(g){return(0,l.setVal)(g,e,m)}),typeof y.preventDefault=="function"&&y.preventDefault()}};n.current=s>0?d:E(d,s)}return n.current(c)},[])}function Ye(e,r){return v.memo(function(n){var t=n.name,u=Array.isArray(t)?t:t.split("."),a=[j].concat(C()(u)),i=[j].concat(C()(u));u.push("value"),i.push("value");var c=e.useState(function(y){return(0,l.getVal)(y,a)}),o=A()(c,2),p=o[0],s=o[1],d=ke(i,s),h=we(e,i),m=Je(r.getFieldName(u),p,h,d);return n.render?(0,b.jsx)(S,{fieldProps:m,children:n.render}):Array.isArray(n.children)?n.children.map(function(y,g){return(0,b.jsx)(S,{fieldProps:m,children:y},g)}):(0,b.jsx)(S,{fieldProps:m,children:n.children})},function(n,t){return n.name===t.name})}var X={name:"SpeedForm",title:"SpeedForm",help:"",tips:"",status:"idle",dirty:ze(["fields"]),validate:Ne({entry:["fields"]}),readonly:!1,enable:!0,visible:!0,fields:{},actions:{}};function Qe(e,r,n,t){e.length>=2&&e[0]==j&&e[e.length-1]==x&&(n.scope||(n.scope="./value"),n.depends||(n.depends=[]),n.depends.push([].concat(C()(e.slice(0,-1)),["value"])),n.initial=null,n.group=x,n.enable=!0)}function Xe(e){return(0,Ae.w)(e,X)}function Ze(e,r,n){e.length>1&&e[e.length-1]=="execute"&&(n.immediate=!1,n.scope?Array.isArray(n.scope)&&n.scope.length>0&&n.scope[0]!=j&&n.scope.unshift(j):n.scope=[j],n.noReentry=!0)}function qe(e,r,n){e.length>0&&e[0]==j&&n.depends&&n.depends.forEach(function(t,u){Array.isArray(t)&&t.length>0&&t[0]!=j?n.depends[u]=[j].concat(C()(t)):typeof t=="string"&&!t.startsWith("".concat(j,"."))&&(n.depends[u]="".concat(j,".").concat(t))})}function _e(e){return function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;e.enableComputed(r)}}function en(e,r){var n=(0,H.w)({getFieldName:function(i){return i.length>0?i[i.length-1]==="value"?i.slice(0,-1).join("."):i.join("."):""},validAt:"once"},r);Xe(e);var t=(0,l.createStore)(e,{debug:n.debug,scope:function(){return[j]},onCreateComputed:function(i,c,o){Qe(i,c,o,n),qe(i,c,o),Ze(i,c,o)},onComputedDraft:function(i,c){var o=c.computedType,p=c.valuePath;if(o==="Computed"&&p.length>0&&p[0]==j)return i.fields}});t.on("computed:created",function(a){Q(a.path)&&(a.options.enable=n.validAt==="once")});var u=t;return{state:u.state,useState:u.useState,setState:u.setState,Form:nn(u,n),Field:W(u,n),Field2:Ye(u,n),Group:z(u,n),Action:D(u,n),Submit:We(u,n),Reset:He(u,n),useAction:Y(u),fields:L(function(){return u.state.fields}),actions:L(function(){return u.state.actions}),getAction:U,freeze:_e(t),load:pe(u,n),getValues:he(u,n),computedObjects:u.computedObjects,watchObjects:u.watchObjects,validate:Ue(u)}}function nn(e,r){return v.forwardRef(function(n,t){var u=n.children,a=(0,v.useCallback)(function(c){r.validAt==="submit"&&e.computedObjects.runGroup(x)},[]),i=(0,v.useCallback)(function(c){},[]);return(0,b.jsx)("form",O()(O()({ref:t,className:"speedform"},n),{},{onSubmit:a,onReset:i,children:u}))})}function Z(e){var r=(0,v.useRef)(e);return r.current=e,r}function tn(e){ae()&&typeof e!="function"&&console.error("useUnmount expected parameter is a function, got ".concat(te()(e)));var r=Z(e);(0,v.useEffect)(function(){return function(){r.current()}},[])}function rn(){var e=(0,v.useRef)(!1);return(0,v.useEffect)(function(){return e.current=!1,function(){e.current=!0}},[]),e}}}]);
