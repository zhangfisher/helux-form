"use strict";(self.webpackChunkspeedform_docs=self.webpackChunkspeedform_docs||[]).push([[539],{23539:function(nt,B,l){l.r(B),l.d(B,{$:function(){return s.$},ActionChildren:function(){return T},ComputedObjects:function(){return s.ComputedObjects},ComputedScopeRef:function(){return s.ComputedScopeRef},FieldChildren:function(){return E},OBJECT_PATH_DELIMITER:function(){return s.OBJECT_PATH_DELIMITER},SKIP_COMPUTED:function(){return s.SKIP_COMPUTED},ValidationError:function(){return Ne},WatchObject:function(){return s.WatchObject},WatchObjects:function(){return s.WatchObjects},action:function(){return G},asyncComputedObject:function(){return s.asyncComputedObject},computed:function(){return s.computed},createActionComponent:function(){return D},createAsyncComputedMutate:function(){return s.createAsyncComputedMutate},createComputedMutate:function(){return s.createComputedMutate},createFieldComponent:function(){return W},createFieldGroupComponent:function(){return z},createForm:function(){return Z},createObject:function(){return s.createObject},createStore:function(){return s.createStore},createUseAction:function(){return k},createUseWatch:function(){return s.createUseWatch},createWatch:function(){return s.createWatch},defaultFormProps:function(){return X},getAction:function(){return N},getSnap:function(){return s.getSnap},getVal:function(){return s.getVal},getValueByPath:function(){return s.getValueByPath},installComputed:function(){return s.installComputed},installWatch:function(){return s.installWatch},isIncludePath:function(){return s.isIncludePath},isSkipComputed:function(){return s.isSkipComputed},markRaw:function(){return s.markRaw},setAsyncComputedObject:function(){return s.setAsyncComputedObject},setVal:function(){return s.setVal},skipComputed:function(){return s.skipComputed},submit:function(){return je},useForm:function(){return et},useLatest:function(){return q},useUnmount:function(){return qe},useUnmountedRef:function(){return _e},watch:function(){return s.watch}});var _=l(79664),C=l.n(_),ee=l(70125),j=l.n(ee),te=l(39114),O=l.n(te),v=l(70079),ne=l(26851),re=l.n(ne),S=l(59166);function rt(e){var r=_typeof(e);return e==null||r=="boolean"||r=="number"||r=="string"||r==null}function M(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=0,n,a=!0,u=function i(){if(n==null){a=!0,clearTimeout(t),t=0;return}try{var c=n;n=void 0,e.apply(void 0,C()(c)),t=setTimeout(function(){return i()},r)}finally{}};return function(){for(var i=arguments.length,c=new Array(i),o=0;o<i;o++)c[o]=arguments[o];if(r==0)return e.apply(void 0,c);n=c,(a||t==0)&&(a=!1,u())}}function ut(e,r){var t={};for(var n in e)e[n]!==r[n]&&(t[n]=r[n]);return t}function ue(){return Math.random().toString(36).substring(2)}function L(e){return new Proxy({},{get:function(t,n,a){return e()[n]}})}function ae(e){return(0,S.P)(e)&&"execute"in e&&(0,S.P)(e.execute)&&"loading"in e.execute}function x(e){return(0,S.P)(e)&&"value"in e}function V(e){return Array.isArray(e)}function I(e){return(0,S.P)(e)&&!x(e)&&!ae(e)}function ie(){return!1}var b="fields",at="actions",P="validate",ce="$submit",s=l(38300),y=l(35250);function oe(e,r,t,n){return Object.assign({name:e,help:"",initial:void 0,oldValue:void 0,visible:!0,required:!1,readonly:!1,validate:null,enable:!0,placeholder:""},O()(O()({},r),{},{sync:t,update:n}))}function se(e,r){var t=(0,v.useRef)(null);return(0,v.useCallback)(function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(t.current==null){var a=e.sync(r);t.current=n==0?a:M(a,n)}return t.current},[])}function le(e,r){var t=(0,v.useRef)(null),n=(0,v.useState)(0),a=j()(n,2),u=a[0],i=a[1];return(0,v.useCallback)(function(c,o){var p=Object.assign({debounce:0},o),d=p.debounce;if(t.current==null||u!==d){u!==d&&d>0&&i(d);var f=function(h){return function(g){r(typeof h=="function"?function(A){return h.call(A,A.fields)}:function(A){return(0,s.setVal)(A,e,h)}),typeof g.preventDefault=="function"&&g.preventDefault()}};t.current=d>0?f:M(f,d)}return t.current(c)},[])}var E=v.memo(function(e){return(0,y.jsx)(y.Fragment,{children:typeof e.children=="function"&&e.children(e.fieldProps)})},function(e,r){return Object.entries(e.fieldProps).every(function(t){var n=j()(t,2),a=n[0],u=n[1];return["children","sync","update"].includes(a)?!0:u===r.fieldProps[a]})});function W(e,r){return v.memo(function(t){var n=t.name,a=Array.isArray(n)?n:n.split("."),u=[b].concat(C()(a)),i=[b].concat(C()(a));a.push("value"),i.push("value");var c=e.useState(function(g){return(0,s.getVal)(g,u)}),o=j()(c,2),p=o[0],d=o[1],f=le(i,d),m=se(e,i),h=oe(r.getFieldName(a),p,m,f);return t.render?(0,y.jsx)(E,{fieldProps:h,children:t.render}):Array.isArray(t.children)?t.children.map(function(g,A){return(0,y.jsx)(E,{fieldProps:h,children:g},A)}):(0,y.jsx)(E,{fieldProps:h,children:t.children})},function(t,n){return t.name===n.name})}var H=l(58048);function fe(e,r){return(0,v.useCallback)(function(t){r(function(n){t.call(n,(0,s.getVal)(n,e))})},[])}function K(e,r,t){return(0,H.w)({name:e,help:"",visible:!0,required:!1,readonly:!1,validate:!0,enable:!0,update:t},r)}function z(e,r){return v.memo(function(t){var n=t.name,a=e.useState(),u=j()(a,2),i=u[0],c=u[1],o=Array.isArray(n)?n:n.split("."),p=["fields"].concat(C()(o)),d=(0,s.getVal)(i,p),f=fe(p,c),m=(0,v.useState)(function(){return K(r.getFieldName(o),d,f)}),h=j()(m,2),g=h[0],A=h[1];return(0,v.useEffect)(function(){A(K(r.getFieldName(o),d,f))},[d]),Array.isArray(t.children)?t.children.map(function(tt){return tt(g)}):t.children(g)},function(t,n){return t.name===n.name})}var de=l(90393),F=l.n(de),ve=l(7392),R=l.n(ve),me=l(6597);function J(e){return e.value}function $(e){var r={};return Object.entries(e).forEach(function(t){var n=j()(t,2),a=n[0],u=n[1];if(typeof a=="string")if(x(u))r[a]=J(u);else if(I(u)){var i=$(u);i&&Object.keys(i).length>0&&(r[a]=i)}else V(u)&&(r[a]=w(u))}),r}function w(e){var r=[];return e.forEach(function(t){x(t)?r.push(J(t)):I(t)?r.push($(t)):V(t)?r.push(w(t)):r.push(t)}),r}function pe(e,r,t){var n=Object.assign({},t),a=n.onNotMatch,u=a===void 0?function(){}:a;function i(c,o){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];Object.entries(c).forEach(function(d){var f=j()(d,2),m=f[0],h=f[1];if(typeof m=="string"){var g=[].concat(C()(p),[m]);if(m in o){var A=o[m];x(A)?A.value=h:I(A)?(0,S.P)(h)?i(h,A,g):u(g):V(A)?Array.isArray(h)?i(h,A):u(g):o[m]=h}else u(g)}})}i(e,r)}function it(e,r){var t=new FormData,n=Object.assign({getItemName:function(c){return c.join(".")}},r),a=n.getItemName;function u(i,c){if(c!=null){var o=a?a(i):i.join(".");Array.isArray(c)?c.forEach(function(p,d){u([].concat(_toConsumableArray(i),[String(d)]),p)}):isPlainObject(c)?Object.entries(c).forEach(function(p){var d=_slicedToArray(p,2),f=d[0],m=d[1];u([].concat(_toConsumableArray(i),[f]),m)}):t.append(o,c)}}return u([],e),t}function he(e,r){return function(n,a){var u=Object.assign({validate:!0},a);try{e.enableComputed(!1),pe(n,e.state.fields),e.setState(function(i){i.dirty=!1,i.validate=null})}catch(i){console.error(i)}finally{e.enableComputed(!0),u!=null&&u.validate&&e.computedObjects.runGroup(P)}}}function Y(e,r){return $(e)}function ye(e,r){return function(n){var a=Object.assign({},n);return Y((0,s.getSnap)(e.state).fields)}}function N(e,r){return function(){var t=R()(F()().mark(function n(a){var u;return F()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return u=Object.assign({},r,a),Array.isArray(u.scope)&&u.scope.length>0&&u.scope[0]!==b&&u.scope.unshift(b),c.next=4,e.execute.run(u);case 4:if(!e.execute.error){c.next=8;break}throw new Error(e.execute.error);case 8:return c.abrupt("return",e.execute.result);case 9:case"end":return c.stop()}},n)}));return function(n){return t.apply(this,arguments)}}()}function ge(e,r){return(0,v.useCallback)(function(t){var n=Object.assign({},{noReentry:!0,preventDefault:!0},r,t),a=N(e,n);return function(u){a(),u&&n.preventDefault&&typeof u.preventDefault=="function"&&u.preventDefault()}},[e])}function be(e,r){return(0,v.useCallback)(function(t){var n=(0,s.getValueByPath)(e,[].concat(C()(Array.isArray(r)?r:r.split(".")),["execute"]));n.cancel(),t&&typeof t.preventDefault=="function"&&t.preventDefault()},[])}function Ae(e,r,t,n){return Object.assign({help:"",title:"",visible:!0,enable:!0},(0,me.C)(e,"execute"),O()(O()({},e.execute),{},{run:r,cancel:t,ref:n}))}var T=v.memo(function(e){return(0,y.jsx)(y.Fragment,{children:typeof e.children=="function"&&e.children(e.actionProps)})},function(e,r){return Object.entries(e.actionProps).every(function(t){var n=j()(t,2),a=n[0],u=n[1];return["children","run","cancel"].includes(a)?!0:u===r.actionProps[a]})});function D(e,r){function t(n){var a=e.useState(),u=j()(a,1),i=u[0],c=n.name;c.includes(".")||(c="actions.".concat(c));var o=(0,s.getValueByPath)(i,c,"."),p=ge(o,n),d=be(i,c),f=(0,v.useRef)(null),m=Ae(o,p,d,f);if(typeof n.render=="function")return(0,y.jsx)(T,{actionProps:m,children:n.render});if(n.children)return Array.isArray(n.children)?n.children.map(function(h,g){return(0,y.jsx)(T,{actionProps:m,children:h},g)}):(0,y.jsx)(T,{actionProps:m,children:n.children})}return v.memo(t,function(n,a){return n.name===a.name})}function G(e,r){return(0,s.computed)(function(){var t=R()(F()().mark(function n(a,u){var i;return F()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i=Y(Object.assign({},a)),o.next=3,e(i,u);case 3:return o.abrupt("return",o.sent);case 4:case"end":return o.stop()}},n)}));return function(n,a){return t.apply(this,arguments)}}(),[],r)}function je(e,r){return G(function(){var t=R()(F()().mark(function n(a,u){var i;return F()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i=new FormData,o.next=3,e(i,u);case 3:return o.abrupt("return",o.sent);case 4:case"end":return o.stop()}},n)}));return function(n,a){return t.apply(this,arguments)}}(),r)}function k(e){return function(t,n){var a=(0,v.useRef)(),u=e.useState(),i=j()(u,2),c=i[0],o=i[1],p=(0,v.useState)(function(){return n!=null&&n.name?n==null?void 0:n.name:ue()}),d=j()(p,1),f=d[0];return a.current||(o(function(m){f in m.actions||(m.actions[f]={execute:G(t,n)})}),a.current=f),(0,s.getValueByPath)(c,["actions",f]).execute}}var Ce=l(20842),Oe=l(71698),Fe=l.n(Oe),Se=l(41176),Pe=l.n(Se),xe=l(77937),Ee=l.n(xe),Re=l(65523),Te=l.n(Re),De=l(7122),Ve=l.n(De),Ie=l(19108),$e=l.n(Ie),Ne=function(e){Te()(t,e);var r=Ve()(t);function t(n){var a;return Ee()(this,t),a=r.call(this,n),a.name="ValidationError",a}return Pe()(t)}($e()(Error));function Q(e){return e.length>1&&e[0]==b&&(e[e.length-1]==="validate"||e.length>=2&&e[e.length-2]=="validate"&&e[e.length-1]=="result")&&!(e.length==2&&e[1]=="validate")&&!(e.length==3&&e[1]=="validate"&&e[2]=="result")}function Ge(e){var r=Object.assign({},e),t=r.entry;return(0,s.watch)(function(n,a,u){if((0,s.isIncludePath)(t||u.path,n)){if(typeof a=="boolean"){var i=n.join(s.OBJECT_PATH_DELIMITER);a?delete u.cache[i]:u.cache[i]=a}return Object.keys(u.cache).length==0}},function(n){return Q(n)},{initial:!0})}function ct(e,r){var t=typeof e=="function"?e():e;if(!t)throw new ValidationError(typeof r=="function"?r():r)}function Ue(e){return function(){var r=R()(F()().mark(function t(n){var a,u,i,c,o,p;return F()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(Array.isArray(n)&&n.length>0){a=n.join(s.OBJECT_PATH_DELIMITER),u=Fe()(e.computedObjects);try{for(u.s();!(i=u.n()).done;)c=j()(i.value,2),o=c[0],p=c[1],o.startsWith(a)&&p.run()}catch(m){u.e(m)}finally{u.f()}}else e.computedObjects.runGroup(P);case 1:case"end":return f.stop()}},t)}));return function(t){return r.apply(this,arguments)}}()}var Be=l(8033);function Me(e){var r={};return Object.entries(e||{}).forEach(function(t){var n=_slicedToArray(t,2),a=n[0],u=n[1];isFieldValue(u)||isFieldGroup(u)||isFieldList(u)||(r[a]=u)}),r}function Le(e){return Object.assign({type:"submit",help:"",title:"",dirty:!1,validate:!0,visible:!0,enable:!0,readOnly:!0},Me(e))}var U=null,We=(0,Be.zo)(function(e,r){var t,n=r.className,a=e.visible;return(0,y.jsx)("input",{className:n+" "+e.className,style:e.style,type:(t=e.type)!==null&&t!==void 0?t:"submit",value:e.title})},{cursor:"pointer",width:"100%",display:"block",boxSizing:"border-box",padding:"8px",borderRadius:"8px",transition:"filter 0.3s","&:hover":{filter:"brightness(1.2)"},"&.speedform-submit":{backgroundColor:"#54b2ff",color:"white",border:"1px solid #1e5786"}});function ot(e,r,t){var n=Object.assign({preventDefault:!1},r);function a(u){var i=e.useState(),c=_slicedToArray(i,1),o=c[0],p=u.scope,d=getValueByPath(o,p),f=Le(d),m=typeof u.render=="function"?1:Array.isArray(u.children)?2:typeof u.children=="function"?3:0;return _jsxs(_Fragment,{children:[_jsx(We,_objectSpread({visible:m==0},n)),m===1?_jsx(U,{submitProps:f,children:u.render}):m===2?u.children.map(function(h,g){return _jsx(U,{submitProps:f,children:h},g)}):_jsx(U,{submitProps:f,children:u.children})]})}return React.memo(a,function(u,i){return u.scope===i.scope})}function He(e,r){var t=D(e,r);return function(n){return(0,y.jsx)(t,O()(O()({},n),{},{name:ce,children:function(u){var i=u.title,c=u.visible,o=u.loading,p=u.enable,d=u.run,f=u.cancel,m=u.error,h=u.progress;return(0,y.jsxs)("div",{className:"speedform-submit",children:["\u63D0\u4EA4",(0,y.jsx)("input",{type:"submit"}),(0,y.jsx)("span",{children:o?"\u63D0\u4EA4\u4E2D":"\u5DF2\u63D0\u4EA4"})]})}}))}}function Ke(e,r){var t=D(e,r);return function(n){return(0,y.jsx)(t,{name:"ffff",children:function(u){return(0,y.jsx)("input",{type:"submit",value:n.title})}})}}function ze(e){return e.length>1&&e[0]==b&&e[e.length-1]=="value"}function Je(e){return(0,s.watch)(function(r,t,n){if((0,s.isIncludePath)(e||n.path,r)&&!n.value)return!0},function(r){return ze(r)},{initial:!1})}var X={name:"SpeedForm",title:"SpeedForm",help:"",tips:"",status:"idle",dirty:Je(["fields"]),validate:Ge({entry:["fields"]}),readonly:!1,enable:!0,visible:!0,actions:{},fields:{}};function we(e,r,t,n){e.length>=2&&e[0]==b&&e[e.length-1]==P&&(t.scope||(t.scope="value"),t.depends||(t.depends=[]),t.depends.push([].concat(C()(e.slice(0,-1)),["value"])),t.initial=null,t.group=P,t.enable=!0)}function Ye(e){return(0,Ce.w)(e,X)}function ke(e,r,t){e.length>1&&e[e.length-1]=="execute"&&(t.immediate=!1,t.scope?Array.isArray(t.scope)&&t.scope.length>0&&t.scope[0]!=b&&t.scope.unshift(b):t.scope=[b],t.noReentry=!0)}function Qe(e,r,t){e.length>0&&e[0]==b&&t.depends&&t.depends.forEach(function(n,a){Array.isArray(n)&&n.length>0&&n[0]!=b?t.depends[a]=[b].concat(C()(n)):typeof n=="string"&&!n.startsWith("".concat(b,"."))&&(t.depends[a]="".concat(b,".").concat(n))})}function Xe(e){return function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;e.enableComputed(r)}}function Z(e,r){var t=(0,H.w)({getFieldName:function(i){return i.length>0?i[i.length-1]==="value"?i.slice(0,-1).join("."):i.join("."):""},validAt:"once"},r);Ye(e);var n=(0,s.createStore)(e,{debug:t.debug,scope:function(){return[b]},onCreateComputed:function(i,c,o){we(i,c,o,t),Qe(i,c,o),ke(i,c,o)},onComputedDraft:function(i,c){var o=c.computedType,p=c.valuePath;if(o==="Computed"&&p.length>0&&p[0]==b)return i.fields}});n.on("computed:created",function(u){Q(u.path)&&(u.options.enable=t.validAt==="once")});var a=n;return{state:a.state,useState:a.useState,setState:a.setState,Form:Ze(a,t),Field:W(a,t),Group:z(a,t),Action:D(a,t),Submit:He(a,t),Reset:Ke(a,t),useAction:k(a),fields:L(function(){return a.state.fields}),actions:L(function(){return a.state.actions}),getAction:N,freeze:Xe(n),load:he(a,t),getValues:ye(a,t),computedObjects:a.computedObjects,watchObjects:a.watchObjects,validate:Ue(a)}}function Ze(e,r){return v.forwardRef(function(t,n){var a=t.children,u=(0,v.useCallback)(function(c){r.validAt==="submit"&&e.computedObjects.runGroup(P)},[]),i=(0,v.useCallback)(function(c){},[]);return(0,y.jsx)("form",O()(O()({ref:n,className:"speedform"},t),{},{onSubmit:u,onReset:i,children:a}))})}function q(e){var r=(0,v.useRef)(e);return r.current=e,r}function qe(e){ie()&&typeof e!="function"&&console.error("useUnmount expected parameter is a function, got ".concat(re()(e)));var r=q(e);(0,v.useEffect)(function(){return function(){r.current()}},[])}function _e(){var e=(0,v.useRef)(!1);return(0,v.useEffect)(function(){return e.current=!1,function(){e.current=!0}},[]),e}function et(e,r){var t=(0,v.useRef)();return t.current==null&&(t.current=Z(e(),r)),t.current}}}]);
