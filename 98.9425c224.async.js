(self.webpackChunkspeedform_docs=self.webpackChunkspeedform_docs||[]).push([[98],{73894:function(Ce,D,d){"use strict";d.r(D),d.d(D,{$:function(){return C.$},ComputedObjects:function(){return De},ComputedScopeRef:function(){return j},OBJECT_PATH_DELIMITER:function(){return b},SKIP_COMPUTED:function(){return ne},WatchObject:function(){return Ie},WatchObjects:function(){return Me},asyncComputedObject:function(){return st},computed:function(){return de},createAsyncComputedMutate:function(){return ue},createComputedMutate:function(){return ae},createObject:function(){return C.share},createStore:function(){return St},createUseWatch:function(){return $e},createWatch:function(){return pe},getSnap:function(){return C.getSnap},getVal:function(){return $},getValueByPath:function(){return R},installComputed:function(){return oe},installWatch:function(){return ve},isIncludePath:function(){return Be},isSkipComputed:function(){return Oe},markRaw:function(){return C.markRaw},setAsyncComputedObject:function(){return rt},setVal:function(){return E},skipComputed:function(){return N},watch:function(){return mt}});var j=function(t){return t.Root="root",t.Current="current",t.Parent="parent",t.Depends="depends",t.Self="self",t}({});function V(t){return(t||["ROOT"]).map(function(e){return Array.isArray(e)?e.join("."):e}).join("_")}function te(t,e){var n="";return e.id?n=e.id:n=V(t),n}function Ke(t){return t instanceof Error?t:new Error(t)}var b=".",ne=Symbol("SKIP_COMPUTED");function Oe(t){return t[ne]===!0}var xe=d(79664),O=d.n(xe);function re(t,e,n){if(!Array.isArray(t))throw new Error("curPath must be an array");return e==="self"?t:e==="root"?[]:e==="parent"?t.slice(0,-2):e==="current"?t.slice(0,-1):typeof e=="string"?e.startsWith("./")?[].concat(O()(t.slice(0,-1)),O()(e.slice(2).split(b))):e.startsWith("../")?re(t.slice(0,-1),e.slice(3),!0):e.startsWith("/")?(e=e.replace(/^(\/)*/,""),O()(e.split(b))):n?[].concat(O()(t.slice(0,-1)),O()(e.split(b))):O()(e.split(b)):Array.isArray(e)?e:t}function je(t,e){var n=t.get(e);if(n!==void 0)return n;var a=t.get(Number(e)||e);if(a!==void 0)return a}function we(t){return toString.call(t)==="[object Map]"}function $(t,e){if(e.length===0)return t;var n,a=t;return e.forEach(function(r){n=we(a)?je(a,r):a[r],a=n}),n}function He(t,e,n){return t.map(function(a){return $(e,re(n,a))})}function Fe(t){return(t||[]).map(function(e){return Array.isArray(e)?e:typeof e=="string"?["/","./","../"].some(function(n){return e.startsWith(n)})?e:e.includes(b)?e.split(b):e.split("."):[]})}var ze=d(26851),Se=d.n(ze);function At(t){return _typeof(t)=="object"&&t.hasOwnProperty("__COMPUTED__")&&["async","sync"].includes(t.__COMPUTED__)&&t.hasOwnProperty("fn")&&typeof t.fn=="function"&&t.hasOwnProperty("options")&&_typeof(t.options)=="object"}function Et(t){return _typeof(t)=="object"&&["result","loading","timeout","retry","run"].every(function(e){return t.hasOwnProperty(e)})}function Be(t,e){return t.length>e.length?!1:t.every(function(n,a){return n===e[a]})}function Le(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"log",n=typeof t=="function"?t():t instanceof Error?t.stack:t;try{var a;(a=console)[e].apply(a,["[@speedform/reactive] "].concat(O()(Array.isArray(n)?n:[n])))}catch(r){}}function E(t,e,n){var a=t,r=e.length-1;e.forEach(function(i,u){var s=we(a);if(u===r){s?a.set(i,n):a[i]=n;return}var o=s?je(a,i):a[i];a=o})}function N(t){return t[ne]=!0,t}function R(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:b,a=[];try{return typeof e=="function"&&(e=e.call(t,t)),a=Array.isArray(e)?e:typeof e=="string"?e.split(n):[],a.length>0?$(t,a):t}catch(r){return t}}function Je(t,e){function n(a,r){for(var i in a){var u=a[i];typeof e=="function"&&e({value:u,key:i,parent:a,path:r.concat(i)}),Se()(u)==="object"&&n(u,r.concat(i))}}n(t,[])}function Ye(t,e,n){var a=e==null?n:e;if(typeof a=="function")try{a=a.call(t,t)}catch(r){}return a==null?n==null?j.Root:n:a}function Ae(t,e,n){var a=n.draft,r=n.dependValues,i=n.valuePath,u=n.computedType,s=a;if(typeof t.options.onComputedDraft=="function"){var o=t.options.onComputedDraft.call(a,a,{computedType:u,valuePath:i});o!==void 0&&(s=o)}var l=i.length>=1?i.slice(0,i.length-1):[],c=Ye(a,e.scope,t.options.scope&&t.options.scope(u));try{if(c===j.Current)return R(a,l);if(c===j.Parent)return R(a,i.slice(0,i.length-2));if(c===j.Root)return s;if(c===j.Depends)return Array.isArray(r)?r.map(function(v){return typeof v=="function"?v():v}):[];if(typeof c=="string")return R(a,re(i,c));if(Array.isArray(c))if(c.length>0&&c[0].startsWith("@")){var f=R(a,[].concat(O()(c[0].substring(1).split(b)),O()(c.slice(1))));return R(a,f)}else return R(a,c);else if(typeof c=="number"){var p=c>i.length-2?i.length-c-1:0;return R(a,i.slice(0,p))}else return a}catch(v){return a}}var Ze=d(77937),K=d.n(Ze),Qe=d(41176),x=d.n(Qe),Xe=d(79862),I=d.n(Xe),Ee=function(){function t(e,n,a,r){K()(this,t),I()(this,"options",void 0),this.store=e,this.selfReactiveable=n,this.path=a,this.options=Object.assign({},r)}return x()(t,[{key:"id",get:function(){return te(this.options.selfPath,this.options)}},{key:"enable",get:function(){return this.options.enable},set:function(n){this.options.enable=n}},{key:"group",get:function(){return this.options.group}},{key:"async",get:function(){return this.options.async}},{key:"depends",get:function(){return this.options.depends}},{key:"run",value:function(n){var a;return(a=this.store.reactiveable)===null||a===void 0?void 0:a.runComputed(this.id,n)}},{key:"cancel",value:function(){}}]),t}();function Re(t,e,n,a){var r=n.options.onCreateComputed;if(typeof r=="function"&&typeof e=="function"){var i=r.call(n,t,e,a);a.scope||(a.scope=j.Current),typeof i=="function"&&(e=i)}}function X(t,e,n){return Object.assign({loading:!1,timeout:0,retry:0,error:null,result:void 0,progress:0,run:t.reactiveable.markRaw(N(function(a){return t.reactiveable.runComputed(e,Object.assign({},a))})),cancel:t.reactiveable.markRaw(N(function(){console.log("cancel")}))},n)}function qe(t,e,n){var a=t.valuePath,r=t.id,i=t.desc,u=t.resultPath,s=t.getter,o=e.selfReactiveable;n.reactiveable.createComputed({onComputed:function(c){var f=c.draft,p=c.values;if(!e.enable){n.options.log("Sync computed <".concat(i,"> is disabled"),"warn");return}n.options.log("Run sync computed for : ".concat(i)),t.dependValues=p;var v=f,g=Ae(n,e,{draft:f,dependValues:p,valuePath:a,computedType:"Computed"}),h=e.initial;try{h=s.call(v,g),n.emit("computed:done",{path:a,id:r})}catch(S){n.emit("computed:error",{path:a,id:r,error:S})}o?o.setState(function(S){E(S,u,h)}):E(f,u,h)},options:e})}function ae(t,e){var n=t.path,a=t.parent,r=t.value;if(!(a&&!Object.hasOwn(a,n[n.length-1]))){var i=r(),u=i.getter,s=i.options;Re(n,u,e,s);var o=s.selfReactiveable,l=s.selfPath||n,c=te(n,s),f="".concat(c,"_").concat(n.join(b));e.options.log("Create sync computed: ".concat(f));var p={id:c,desc:f,resultPath:l,isComputedRunning:!1,dependValues:[],valuePath:n,deps:[],getter:u};qe(p,s,e),o||t.replaceValue($(e.state,n));var v=new Ee(e,o,n,s);return e.computedObjects.set(c,v),v}}var _e=d(90393),w=d.n(_e),et=d(7392),z=d.n(et),tt=d(70125),B=d.n(tt),C=d(67687),nt=d(10346);function rt(t,e,n,a,r){var i=X(t,a,r),u=$(e,n);Object.assign(u,i,r)}function at(t,e,n){var a=Object.assign({},n),r=a.max,i=r===void 0?100:r,u=a.min,s=u===void 0?0:u,o=a.value,l=o===void 0?0:o;return t(function(c){return E(c,[].concat(O()(e),["progress"]),l)}),{value:function(f){f>i&&(f=i),f<s&&(f=s),t(function(p){return E(p,[].concat(O()(e),["progress"]),f)})},end:function(){this.value(i)}}}function L(t,e,n){t(function(a){Object.entries(n).forEach(function(r){var i=B()(r,2),u=i[0],s=i[1];E(a,[].concat(O()(e),[u]),s)})})}function it(t,e,n,a){return ie.apply(this,arguments)}function ie(){return ie=z()(w()().mark(function t(e,n,a,r){var i,u,s,o,l,c,f,p,v,g,h,S,k,A,H,P,m,he,Y,We,ye,T,Ue,M;return w()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:i=n.id,u=n.valuePath,s=n.getter,o=n.resultPath,l=n.dependValues,c=a.timeout,f=c===void 0?0:c,p=a.retry,v=p===void 0?[0,0]:p,g=a.selfReactiveable,h=g?g.setState:r.setState,S=e,k=Ae(r,a,{draft:e,dependValues:l,valuePath:u,computedType:"Computed"}),A=Array.isArray(v)?v:[Number(v),0],H=B()(A,2),P=H[0],m=H[1],Y=new AbortController,We={onTimeout:function(W){return he=W},getProgressbar:function(W){return at(h,u,W)},getSnap:function(W){return(0,C.getSnap)(W,!1)},abortSignal:Y.signal,cancel:Y.abort},ye=!1,L(h,o,{cancel:(0,C.markRaw)(N(function(){return Y.abort()}))}),Y.signal.addEventListener("abort",function(){ye=!0}),T=!1,Ue=w()().mark(function _(){var W,ee,Z,U,Ge,ge,me,Q,be,G,Ne;return w()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(T=!1,Z=!1,U={},y.prev=3,Ge=Array.isArray(f)?f:[f,0],ge=B()(Ge,2),me=ge[0],Q=me===void 0?0:me,be=ge[1],G=be===void 0?0:be,L(h,o,{loading:!0,error:null,retry:M>0?P-M:0,timeout:G>1?G:Q,progress:0}),!ye){y.next=8;break}throw new Error("Aborted");case 8:return Q>0&&(W=setTimeout(function(){Z=!0,typeof he=="function"&&he(),T||(clearInterval(ee),L(h,o,{loading:!1,error:"TIMEOUT",timeout:0}))},Q),G>1&&(ee=setInterval(function(){L(h,o,{timeout:G--}),G===0&&clearInterval(ee)},Q/G))),y.next=11,s.call(S,k,We);case 11:Ne=y.sent,Z||Object.assign(U,{result:Ne,error:null,timeout:0}),y.next=20;break;case 15:y.prev=15,y.t0=y.catch(3),T=y.t0,Z||Object.assign(U,{error:Ke(y.t0).message,timeout:0}),P>0&&Object.assign(U,{retry:P-M});case 20:return y.prev=20,clearTimeout(W),clearInterval(ee),(!T||M==P)&&Object.assign(U,{loading:!1}),!T&&!Z&&Object.assign(U,{error:null}),L(h,o,U),y.finish(20);case 27:if(!T){y.next=31;break}if(!(P>0&&m>0&&M<P)){y.next=31;break}return y.next=31,(0,nt.g)(m);case 31:case"end":return y.stop()}},_,null,[[3,15,20,27]])}),M=0;case 14:if(!(M<P+1)){F.next=19;break}return F.delegateYield(Ue(),"t0",16);case 16:M++,F.next=14;break;case 19:T?r.emit("computed:error",{path:u,id:i,error:T}):r.emit("computed:done",{path:u,id:i});case 20:case"end":return F.stop()}},t)})),ie.apply(this,arguments)}function ut(t,e,n){var a=t.valuePath,r=t.id,i=t.deps,u=t.desc,s=t.isComputedRunning,o=e.selfReactiveable,l=e.initial,c=e.noReentry;n.reactiveable.createAsyncComputed({depends:function(p){return He(i,p,a)},initial:function(p){o?o.setState(function(v){Object.assign(v,X(n,r,{result:l}))}):E(p,a,X(n,r,{result:l}))},onComputed:function(){var f=z()(w()().mark(function v(g){var h,S,k,A,H;return w()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(h=g.draft,S=g.values,k=g.options,!(!n.options.enableComputed||!e.enable&&(k==null?void 0:k.enable)!==!0)){m.next=4;break}return n.options.log("Async computed <".concat(u,"> is disabled"),"warn"),m.abrupt("return");case 4:if(n.options.log("Run async computed for : ".concat(u)),A=Object.assign({},e,k),!(c&&s&&n.options.debug)){m.next=9;break}return n.options.log("Reentry async computed: ".concat(u),"warn"),m.abrupt("return");case 9:return t.isComputedRunning=!0,t.dependValues=S,m.prev=11,m.next=14,it(h,t,A,n);case 14:return H=m.sent,m.abrupt("return",H);case 16:return m.prev=16,t.isComputedRunning=!1,m.finish(16);case 19:case"end":return m.stop()}},v,null,[[11,,16,19]])}));function p(v){return f.apply(this,arguments)}return p}(),options:e})}function ue(t,e){var n=t.path,a=t.parent,r=t.value;if(!(a&&!Object.hasOwn(a,n[n.length-1]))){var i=r(),u=i.getter,s=i.options;s.async=!0,Re(n,u,e,s);var o=s.depends,l=o===void 0?[]:o,c=s.selfReactiveable,f=s.selfPath||n;l.length==0&&e.options.log("async computed <".concat(n.join("."),"> should specify depends"),"warn");var p=te(n,s),v="".concat(p,"_").concat(n.join(b));e.options.log("Create async computed: ".concat(v," (depends=").concat(l.length==0?"None":V(l),")"));var g={id:p,desc:v,resultPath:f,isComputedRunning:!1,dependValues:[],valuePath:n,deps:l,getter:u};ut(g,s,e),c||t.replaceValue($(e.state,n));var h=new Ee(e,c,n,s);return e.computedObjects.set(p,h),h}}function st(t){return Object.assign({loading:!1,timeout:0,retry:0,error:null,result:void 0,progress:0,run:(0,C.markRaw)(N(function(e){})),cancel:(0,C.markRaw)(N(function(){}))},t)}var se=d(20649);function oe(t,e){var n=t.value,a;return n.__COMPUTED__=="async"?a=ue(t,e):n.__COMPUTED__=="sync"?a=ae(t,e):(0,se.$)(n)?(t.value=function(){return{getter:n,options:{depends:[],initial:void 0,immediate:!0,enable:!0}}},a=ue(t,e)):(t.value=function(){return{getter:n,options:{initial:void 0,enable:!0}}},a=ae(t,e)),a&&e.emit("computed:created",a),a}var ot=d(71698),ce=d.n(ot),ct=d(44114),J=d.n(ct),lt=d(19365),ft=d.n(lt),dt=d(72904),pt=d.n(dt),vt=d(65523),le=d.n(vt),ht=d(7122),fe=d.n(ht),yt=d(19108),ke=d.n(yt);function de(t,e,n){if(typeof t!="function")throw new Error("computed getter must be a function");var a=[],r={async:!1,enable:!0,timeout:0,depends:[],immediate:!0};if(arguments.length==1)a=[];else if(arguments.length==2)if(Array.isArray(arguments[1]))a=arguments[1];else if(Se()(arguments[1])=="object")Object.assign(r,arguments[1]);else throw new Error("invalid arguments");else arguments.length>=3&&(a=arguments[1],Object.assign(r,arguments[2]));var i=r.async===!0||(0,se.$)(t)||arguments.length>=2&&Array.isArray(e);r.async=i,r.depends=Fe(a);var u=function(){return{getter:t,options:r}};return u.__COMPUTED__=i?"async":"sync",u}function q(){return Math.random().toString(36).slice(2)}var gt=function(){function t(e,n){K()(this,t)}return x()(t,[{key:"state",get:function(){throw new Error("state not implemented.")}},{key:"useState",value:function(n,a){throw new Error("useState not implemented.")}},{key:"setState",value:function(n){throw new Error("setState not implemented.")}},{key:"createAsyncComputed",value:function(n){throw new Error("createAsyncComputed not implemented.")}},{key:"createComputed",value:function(n){throw new Error("createComputed not implemented.")}},{key:"runComputed",value:function(n,a){throw new Error("runComputed not implemented.")}},{key:"markRaw",value:function(n){throw new Error("makeRaw not implemented.")}}]),t}(),Pe=function(t){le()(n,t);var e=fe()(n);function n(a,r){var i,u;return K()(this,n),u=e.call(this,a,r),I()(J()(u),"_stateCtx",void 0),u._stateCtx=(0,C.sharex)(a,{stopArrDep:!1,moduleName:(i=r==null?void 0:r.id)!==null&&i!==void 0?i:q(),onRead:function(o){r!=null&&r.onRead&&r.onRead({path:o.fullKeyPath,value:o.value,parent:o.parent,replaceValue:o.replaceValue})}}),u}return x()(n,[{key:"state",get:function(){return this._stateCtx.reactive}},{key:"useState",value:function(r,i){var u=this._stateCtx.useState(),s=B()(u,2),o=s[0],l=s[1],c=typeof r=="function"?r(o):o,f=typeof i=="function"?function(p){l(function(v){i.call(v,v,p)})}:l;return[c,f]}},{key:"setState",value:function(r){this._stateCtx.setState(r)}},{key:"createAsyncComputed",value:function(r){var i=r.initial,u=r.onComputed,s=r.depends,o=r.options;return this._stateCtx.mutate({deps:function(c){return typeof s=="function"?s(c):null},fn:function(c,f){f.isFirstCall&&typeof i=="function"&&i(c,f)},task:function(){var l=z()(w()().mark(function f(p){var v,g,h,S;return w()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(v=p.draft,g=p.setState,h=p.input,S=p.extraArgs,typeof i!="function"){A.next=3;break}return A.abrupt("return",u({draft:v,setState:g,values:h,options:Object.assign({},S)}));case 3:case"end":return A.stop()}},f)}));function c(f){return l.apply(this,arguments)}return c}(),immediate:o.immediate,desc:o.id,checkDeadCycle:!1}),o.id}},{key:"createComputed",value:function(r){var i=r.onComputed,u=r.options;return this._stateCtx.mutate({fn:function(o,l){var c=l.input;typeof i=="function"&&i({draft:o,values:c})},desc:u.id,checkDeadCycle:!1}),u.id}},{key:"runComputed",value:function(r,i){var u={desc:r,extraArgs:i};this._stateCtx.runMutateTask(u)}},{key:"markRaw",value:function(r){return(0,C.markRaw)(r)}}]),n}(gt);function Te(t){return function(e,n,a){var r=Object.assign({id:q(),selfPath:["value"],depends:n},a);if(!Array.isArray(r.depends)||r.depends.length==0)throw new Error("depends must be an array and not empty");var i=r.async===!0||(0,se.$)(e);r.selfReactiveable=new Pe({value:i?X(t,r.id,{}):r.initial});var u;r.async?u={path:[],parent:null,value:de(e,r.depends,r)}:u={path:[],parent:null,value:de(e,r)};var s=oe(u,t);return{value:r.selfReactiveable.state.value,computedObject:s}}}var De=function(t){le()(n,t);var e=fe()(n);function n(a){var r;return K()(this,n),r=e.call(this),I()(J()(r),"_createComputed",void 0),r.store=a,r}return x()(n,[{key:"runGroup",value:function(){var a=z()(w()().mark(function i(u){return w()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",Promise.all(O()(this.values()).filter(function(l){return l.group==u}).map(function(l){return l.async,l.run()})));case 1:case"end":return o.stop()}},i,this)}));function r(i){return a.apply(this,arguments)}return r}()},{key:"enableGroup",value:function(){var a=z()(w()().mark(function i(u){var s,o,l;return w()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:s=ce()(this.values());try{for(s.s();!(o=s.n()).done;)l=o.value,l.options.enable=u}catch(p){s.e(p)}finally{s.f()}case 2:case"end":return f.stop()}},i,this)}));function r(i){return a.apply(this,arguments)}return r}()},{key:"delete",value:function(r){return ft()(pt()(n.prototype),"delete",this).call(this,r)}},{key:"create",get:function(){return this._createComputed||(this._createComputed=Te(this.store)),this._createComputed}}]),n}(ke()(Map));function Ve(t){return typeof t=="function"?t:typeof t=="string"?function(e){return V(e)==V(t.split(b))}:Array.isArray(t)?function(e){return t.map(function(n){return typeof n=="string"?n.split(b):Array.isArray(n)?n:[String(n)]}).some(function(n){return V(e)==V(n)})}:function(){return!1}}function mt(t,e,n){var a=Object.assign({depends:Ve(e),enable:!0},n),r=function(){return{listener:t,options:a}};return r.__COMPUTED__="watch",r}function pe(t){return function(e,n){var a=(0,C.watch)(function(i){var u=i.triggerReasons,s=u.map(function(o){return o.keyPath});e(s)},function(){return n==null?void 0:n.map(function(i){return R(t.stateCtx.state,i)})}),r=a.unwatch;return r}}var bt=d(70079);function ve(t,e){e.options.log("install watch for <".concat(t.path.length==0?"Dynamic":t.path.join(b),">"));var n=t.value();n.options.selfPath=t.path;var a=e.watchObjects.add(n),r=n.options.context;return r?r.setState(function(i){i.value=n.options.initial}):(t.replaceValue(n.options.initial),e.stateCtx.setState(function(i){E(i,t.path,n.options.initial)}),(0,C.flush)(e.stateCtx.state)),a}function $e(t){return function(e,n,a){(0,bt.useEffect)(function(){var r={path:["value"],parent:void 0,value:function(){var s={listener:e,options:Object.assign({depends:Ve(n),context:(0,C.sharex)({value:0}),selfPath:["value"],initial:0,enable:!0,scope:j.Depends},a)};return s}},i=ve(r,t);return function(){t.watchObjects.delete(i.id)}},[n])}}var Ie=function(){function t(e,n){if(K()(this,t),I()(this,"_cache",void 0),I()(this,"_listener",void 0),I()(this,"_options",void 0),this.store=e,this._options=Object.assign({enable:!0,selfPath:[],group:void 0,context:void 0,initial:void 0},n.options),typeof this._options.depends!="function")throw new Error("watch options.depends must be a function");if(!this._options.id){var a=this._options.selfPath;this._options.id=this._options.id||this._options.context?q():V(a)}this._listener=n.listener}return x()(t,[{key:"id",get:function(){return this._options.id}},{key:"options",get:function(){return this._options}},{key:"selfPath",get:function(){return this._options.selfPath}},{key:"depends",get:function(){return this._options.depends}},{key:"enable",get:function(){return this._options.enable},set:function(n){this._options.enable=n}},{key:"cache",get:function(){return this._cache||(this._cache={}),this._cache}},{key:"value",get:function(){var n=this._options.context?this._options.context:this.store.state;return $((0,C.getSnap)(n),this.selfPath)}},{key:"getName",value:function(){return this._options.context?this.id:this.selfPath.join(b)}},{key:"reset",value:function(){this._cache={}}},{key:"run",value:function(n,a){var r=this;if(!this.enable){this.store.options.log("WatchObject <".concat(this.getName(),"> is disabled"));return}try{var i=this._listener.call(this,a,n,this);i!==void 0&&(this._options.context?this._options.context.setState(function(u){u.value=i}):this.store.setState(function(u){E(u,r.selfPath,i)}))}catch(u){}}}]),t}(),Me=function(t){le()(n,t);var e=fe()(n);function n(a){var r;return K()(this,n),r=e.call(this),I()(J()(r),"_off",void 0),I()(J()(r),"_enable",!0),r.store=a,a.on("created",r.onStateCreated.bind(J()(r))),r}return x()(n,[{key:"onStateCreated",value:function(){this.createWacher()}},{key:"enable",get:function(){return this._enable},set:function(r){this._enable=r}},{key:"createWacher",value:function(){var r=this,i=(0,C.watch)(function(s){var o=s.triggerReasons;if(r._enable){var l=o.map(function(c){return c.keyPath});l.forEach(function(c){var f=$(r.store.state,c),p=ce()(r.values()),v;try{for(p.s();!(v=p.n()).done;){var g=v.value;g.depends(c,f)&&g.run(c,f)}}catch(h){p.e(h)}finally{p.f()}})}},function(){return[r.store.state]}),u=i.unwatch;this._off=u}},{key:"reset",value:function(){this._off&&this._off(),this.createWacher()}},{key:"add",value:function(r){var i=new Ie(this.store,r);return this.set(i.id,i),i}},{key:"enableGroup",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,u=ce()(this.values()),s;try{for(u.s();!(s=u.n()).done;){var o=s.value;o.options.group==r&&(o.options.enable=i)}}catch(l){u.e(l)}finally{u.f()}}}]),n}(ke()(Map));function Ct(t,e){var n=t.path,a=t.value,r=V(n);typeof a=="function"&&!e._replacedKeys[r]&&!Oe(a)&&(e._replacedKeys[r]=!0,a.__COMPUTED__=="watch"?ve(t,e):oe(t,e))}function Ot(t){return function(e,n){var a=t.stateCtx.useState;if(e==null)return a();var r=a(),i=B()(r,2),u=i[0],s=i[1],o=e(u),l=s;return typeof n=="function"&&(l=function(f){s(function(p){n.call(p,p,f)})}),[o,l]}}function jt(t){return function(e){t.reactiveable.setState(function(n){e(n)})}}var wt=d(24222);function St(t,e){var n=Object.assign({id:q(),debug:!0,onceComputed:!1,enableComputed:!0,scope:function(){return j.Current}},e);n.log=function(){n.debug&&Le.apply(void 0,arguments)};var a=(0,wt.Z)(),r={options:n,on:a.on,off:a.off,emit:a.emit,_replacedKeys:{}};return r.computedObjects=new De(r),r.watchObjects=new Me(r),r.reactiveable=new Pe(t,{id:n.id,onRead:function(u){Ct(u,r)}}),r.state=r.reactiveable.state,r.emit("created"),r.useState=Ot(r),r.setState=jt(r),r.enableComputed=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return r.options.enableComputed=i},r.watch=pe(r),r.useWatch=$e(r),r.watch=pe(r),r.createComputed=Te(r),n.onceComputed&&Je(r.state),r}},43095:function(Ce){function D(d){var j=new Error("Cannot find module '"+d+"'");throw j.code="MODULE_NOT_FOUND",j}D.keys=function(){return[]},D.resolve=D,D.id=43095,Ce.exports=D}}]);
