(self.webpackChunkspeedform_docs=self.webpackChunkspeedform_docs||[]).push([[98],{73894:function(ye,D,d){"use strict";d.r(D),d.d(D,{$:function(){return C.$},ComputedObjects:function(){return Pe},ComputedScopeRef:function(){return w},OBJECT_PATH_DELIMITER:function(){return b},SKIP_COMPUTED:function(){return ne},WatchObject:function(){return De},WatchObjects:function(){return Ie},asyncComputedObject:function(){return it},computed:function(){return Me},createAsyncComputedMutate:function(){return ue},createAsyncComputedObject:function(){return q},createComputedMutate:function(){return ae},createObject:function(){return C.share},createStore:function(){return wt},createUseWatch:function(){return Te},createWatch:function(){return fe},getSnap:function(){return C.getSnap},getVal:function(){return V},getValueByPath:function(){return P},installComputed:function(){return se},installWatch:function(){return de},isIncludePath:function(){return He},isSkipComputed:function(){return me},markRaw:function(){return C.markRaw},setAsyncComputedObject:function(){return tt},setVal:function(){return M},skipComputed:function(){return G},watch:function(){return gt}});var w=function(e){return e.Root="root",e.Current="current",e.Parent="parent",e.Depends="depends",e.Self="self",e}({}),Re=d(70125),x=d.n(Re);function I(e){return(e||["ROOT"]).map(function(t){return Array.isArray(t)?t.join("."):t}).join("_")}function L(e,t){var n="";return typeof t=="function"?n=t(e):typeof t=="string"?n=t:n=I(e),n}function Ue(e){return e instanceof Error?e:new Error(e)}var b=".",ne=Symbol("SKIP_COMPUTED");function me(e){return e[ne]===!0}var Ne=d(79664),S=d.n(Ne);function re(e,t,n){if(!Array.isArray(e))throw new Error("curPath must be an array");return t==="self"?e:t==="root"?[]:t==="parent"?e.slice(0,-2):t==="current"?e.slice(0,-1):typeof t=="string"?t.startsWith("./")?[].concat(S()(e.slice(0,-1)),S()(t.slice(2).split(b))):t.startsWith("../")?re(e.slice(0,-1),t.slice(3),!0):t.startsWith("/")?(t=t.replace(/^(\/)*/,""),S()(t.split(b))):n?[].concat(S()(e.slice(0,-1)),S()(t.split(b))):S()(t.split(b)):Array.isArray(t)?t:e}function be(e,t){var n=e.get(t);if(n!==void 0)return n;var r=e.get(Number(t)||t);if(r!==void 0)return r}function Ce(e){return toString.call(e)==="[object Map]"}function V(e,t){if(t.length===0)return e;var n,r=e;return t.forEach(function(a){n=Ce(r)?be(r,a):r[a],r=n}),n}function xe(e,t,n){return e.map(function(r){return V(t,re(n,r))})}function Ge(e){return(e||[]).map(function(t){return Array.isArray(t)?t:typeof t=="string"?["/","./","../"].some(function(n){return t.startsWith(n)})?t:t.includes(b)?t.split(b):t.split("."):[]})}var Ke=d(26851),Oe=d.n(Ke);function Et(e){return _typeof(e)=="object"&&e.hasOwnProperty("__COMPUTED__")&&["async","sync"].includes(e.__COMPUTED__)&&e.hasOwnProperty("fn")&&typeof e.fn=="function"&&e.hasOwnProperty("options")&&_typeof(e.options)=="object"}function Mt(e){return _typeof(e)=="object"&&["result","loading","timeout","retry","run"].every(function(t){return e.hasOwnProperty(t)})}function He(e,t){return e.length>t.length?!1:e.every(function(n,r){return n===t[r]})}function Fe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"log",n=typeof e=="function"?e():e instanceof Error?e.stack:e;try{var r;(r=console)[t].apply(r,["[@speedform/reactive] "].concat(S()(Array.isArray(n)?n:[n])))}catch(a){}}function M(e,t,n){var r=e,a=t.length-1;t.forEach(function(i,u){var s=Ce(r);if(u===a){s?r.set(i,n):r[i]=n;return}var o=s?be(r,i):r[i];r=o})}function G(e){return e[ne]=!0,e}function P(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:b,r=[];try{return typeof t=="function"&&(t=t.call(e,e)),r=Array.isArray(t)?t:typeof t=="string"?t.split(n):[],r.length>0?V(e,r):e}catch(a){return e}}function ze(e,t){function n(r,a){for(var i in r){var u=r[i];typeof t=="function"&&t({value:u,key:i,parent:r,path:a.concat(i)}),Oe()(u)==="object"&&n(u,a.concat(i))}}n(e,[])}function Be(e,t,n){var r=t==null?n:t;if(typeof r=="function")try{r=r.call(e,e)}catch(a){}return r==null?n==null?w.Root:n:r}function Le(e,t){var n=t.dependValues,r=t.valuePath,a=t.funcOptions,i=t.storeOptions,u=t.computedType,s=e;if(typeof i.onComputedDraft=="function"){var o=i.onComputedDraft.call(e,e,{computedType:u,valuePath:r});o!==void 0&&(s=o)}var l=r.length>=1?r.slice(0,r.length-1):[],c=Be(e,a.scope,i.scope&&i.scope(u));try{if(c===w.Current)return P(e,l);if(c===w.Parent)return P(e,r.slice(0,r.length-2));if(c===w.Root)return s;if(c===w.Depends)return Array.isArray(n)?n.map(function(v){return typeof v=="function"?v():v}):[];if(typeof c=="string")return P(e,re(r,c));if(Array.isArray(c))if(c.length>0&&c[0].startsWith("@")){var f=P(e,[].concat(S()(c[0].substring(1).split(b)),S()(c.slice(1))));return P(e,f)}else return P(e,c);else if(typeof c=="number"){var p=c>r.length-2?r.length-c-1:0;return P(e,r.slice(0,p))}else return e}catch(v){return e}}function Se(e,t,n,r){var a=n.valuePath,i=n.dependValues;return Le(t,{dependValues:i,valuePath:a,funcOptions:r,storeOptions:e.options,computedType:"Computed"})}var Je=d(77937),K=d.n(Je),Ye=d(41176),H=d.n(Ye),Ze=d(79862),$=d.n(Ze),je=function(){function e(t,n,r,a){K()(this,e),$()(this,"options",void 0),this.store=t,this.selfState=n,this.path=r,this.options=Object.assign({},a)}return H()(e,[{key:"id",get:function(){return L(this.options.selfPath,this.options.id)}},{key:"enable",get:function(){return this.options.enable},set:function(n){this.options.enable=n}},{key:"group",get:function(){return this.options.group}},{key:"async",get:function(){return this.options.async}},{key:"depends",get:function(){return this.options.depends}},{key:"run",value:function(n){var r;return(r=this.store.reactiveable)===null||r===void 0?void 0:r.runComputed(this.id,n)}},{key:"cancel",value:function(){}}]),e}();function we(e,t,n,r){var a=n.options.onCreateComputed;if(typeof a=="function"&&typeof t=="function"){var i=a.call(n,e,t,r);r.scope||(r.scope=w.Current),typeof i=="function"&&(t=i)}}function Qe(e,t){var n=t.id||L(e,t.id),r=t.selfState?n:e.join(b);return[n,r]}function Xe(e,t,n){var r=e.valuePath,a=e.id,i=e.name,u=e.resultPath,s=e.getter,o=t.selfState;n.reactiveable.createComputed({onComputed:function(c){var f=c.draft,p=c.values;if(!t.enable){n.options.log("Sync computed <".concat(i,"> is disabled"),"warn");return}n.options.log("Run sync computed for : ".concat(i)),e.dependValues=p;var v=o||f,g=o?f:Se(n,f,e,t),h=t.initial;try{h=s.call(v,g)}catch(E){if(typeof t.onError=="function")try{var j;(j=t.onError)===null||j===void 0||j.call(v,E)}catch(y){}}o?o.setState(function(E){M(E,u,h)}):M(f,u,h)},options:t})}function ae(e,t){var n=e.path,r=e.parent,a=e.value;if(!(r&&!Object.hasOwn(r,n[n.length-1]))){var i=a(),u=i.getter,s=i.options;we(n,u,t,s);var o=s.selfState,l=o?["value"]:n,c=Qe(n,s),f=x()(c,2),p=f[0],v=f[1];t.options.log("Create sync computed: ".concat(v));var g={id:s.id||L(n,s.id),name:o?p:n.join(b),resultPath:l,isMutateRunning:!1,dependValues:[],valuePath:n,deps:[],getter:u};Xe(g,s,t),o||e.replaceValue(V(t.state,n));var h=new je(t,o,n,s);return t.computedObjects.set(v,h),h}}var qe=d(90393),A=d.n(qe),_e=d(7392),J=d.n(_e),C=d(67687),et=d(10346);function q(e,t,n){return Object.assign({loading:!1,timeout:0,retry:0,error:null,result:void 0,progress:0,run:(0,C.markRaw)(G(function(r){return e.reactiveable.runComputed(t,Object.assign({},r))})),cancel:(0,C.markRaw)(G(function(){console.log("cancel")}))},n)}function tt(e,t,n,r,a){var i=q(e,r,a),u=V(t,n);Object.assign(u,i,a)}function nt(e,t,n){var r=Object.assign({},n),a=r.max,i=a===void 0?100:a,u=r.min,s=u===void 0?0:u,o=r.value,l=o===void 0?0:o;return e(function(c){return M(c,[].concat(S()(t),["progress"]),l)}),{value:function(f){f>i&&(f=i),f<s&&(f=s),e(function(p){return M(p,[].concat(S()(t),["progress"]),f)})},end:function(){this.value(i)}}}function Y(e,t,n){e(function(r){Object.entries(n).forEach(function(a){var i=x()(a,2),u=i[0],s=i[1];M(r,[].concat(S()(t),[u]),s)})})}function rt(e,t,n,r){return ie.apply(this,arguments)}function ie(){return ie=J()(A()().mark(function e(t,n,r,a){var i,u,s,o,l,c,f,p,v,g,h,j,E,y,k,F,W,pe,O,Ve,T;return A()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:i=n.valuePath,u=n.getter,s=n.resultPath,o=r.timeout,l=o===void 0?0:o,c=r.retry,f=c===void 0?[0,0]:c,p=r.selfState,v=p?p.setState:a.setState,g=p||t,h=p?t:Se(a,t,n,r),j=Array.isArray(f)?f:[Number(f),0],E=x()(j,2),y=E[0],k=E[1],W=new AbortController,pe={onTimeout:function(R){return F=R},getProgressbar:function(R){return nt(v,i,R)},getSnap:function(R){return(0,C.getSnap)(R,!1)},abortSignal:W.signal,cancel:W.abort},O=!1,Y(v,s,{cancel:(0,C.markRaw)(G(function(){return W.abort()}))}),W.signal.addEventListener("abort",function(){O=!0}),Ve=A()().mark(function ee(){var R,te,B,Q,At,U,$e,ve,he,X,ge,N,We;return A()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(B=!1,Q=!1,At=T>0,U={},m.prev=2,$e=Array.isArray(l)?l:[l,0],ve=x()($e,2),he=ve[0],X=he===void 0?0:he,ge=ve[1],N=ge===void 0?0:ge,Y(v,s,{loading:!0,error:null,retry:T>0?y-T:0,timeout:N>1?N:X,progress:0}),!O){m.next=7;break}throw new Error("Aborted");case 7:return X>0&&(R=setTimeout(function(){Q=!0,typeof F=="function"&&F(),B||(clearInterval(te),Y(v,s,{loading:!1,error:"TIMEOUT",timeout:0}))},X),N>1&&(te=setInterval(function(){Y(v,s,{timeout:N--}),N===0&&clearInterval(te)},X/N))),m.next=10,u.call(g,h,pe);case 10:We=m.sent,Q||Object.assign(U,{result:We,error:null,timeout:0}),m.next=21;break;case 14:if(m.prev=14,m.t0=m.catch(2),B=!0,typeof r.onError=="function")try{r.onError.call(g,m.t0)}catch(Tt){}Q||Object.assign(U,{error:Ue(m.t0).message,timeout:0}),y>0&&Object.assign(U,{retry:y-T}),a.emit("computed:error",{path:i,id:n.id});case 21:return m.prev=21,clearTimeout(R),clearInterval(te),(!B||T==y)&&Object.assign(U,{loading:!1}),!B&&!Q&&Object.assign(U,{error:null}),Y(v,s,U),m.finish(21);case 28:if(!B){m.next=32;break}if(!(y>0&&k>0&&T<y)){m.next=32;break}return m.next=32,(0,et.g)(k);case 32:case"end":return m.stop()}},ee,null,[[2,14,21,28]])}),T=0;case 13:if(!(T<y+1)){z.next=18;break}return z.delegateYield(Ve(),"t0",15);case 15:T++,z.next=13;break;case 18:case"end":return z.stop()}},e)})),ie.apply(this,arguments)}function at(e,t,n){var r=e.valuePath,a=e.id,i=e.deps,u=e.name,s=e.resultPath,o=e.isMutateRunning,l=e.getter,c=t.selfState,f=t.initial,p=t.noReentry;n.reactiveable.createAsyncComputed({depends:function(g){return xe(i,g,r)},initial:function(g){c?c.setState(function(h){Object.assign(h,q(n,a,{result:f}))}):M(g,r,q(n,a,{result:f}))},onComputed:function(){var v=J()(A()().mark(function h(j){var E,y,k,F,W;return A()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(E=j.draft,y=j.values,k=j.options,!(!n.options.enableComputed||!t.enable&&(k==null?void 0:k.enable)!==!0)){O.next=4;break}return n.options.log("Async computed <".concat(u,"> is disabled"),"warn"),O.abrupt("return");case 4:if(n.options.log("Run async computed for : ".concat(u)),F=Object.assign({},t,k),!(p&&o&&n.options.debug)){O.next=9;break}return n.options.log("Reentry async computed: ".concat(u),"warn"),O.abrupt("return");case 9:return e.isMutateRunning=!0,e.dependValues=y,O.prev=11,O.next=14,rt(E,e,F,n);case 14:return W=O.sent,n.emit("computed:done",{path:r,id:a}),O.abrupt("return",W);case 17:return O.prev=17,e.isMutateRunning=!1,O.finish(17);case 20:case"end":return O.stop()}},h,null,[[11,,17,20]])}));function g(h){return v.apply(this,arguments)}return g}(),options:t})}function ue(e,t){var n=e.path,r=e.parent,a=e.value;if(!(r&&!Object.hasOwn(r,n[n.length-1]))){var i=a(),u=i.getter,s=i.options;s.async=!0,we(n,u,t,s);var o=s.depends,l=o===void 0?[]:o,c=s.selfState,f=c?["value"]:n;l.length==0&&t.options.log("async computed <".concat(n.join("."),"> should specify depends"),"warn");var p=s.id||L(n,s.id),v=c?p:n.join(b);t.options.log("Create async computed: ".concat(v," (depends=").concat(l.length==0?"None":I(l),")"));var g={id:s.id||L(n,s.id),name:c?p:n.join(b),resultPath:f,isMutateRunning:!1,dependValues:[],valuePath:n,deps:l,getter:u};at(g,s,t),c||e.replaceValue(V(t.state,n));var h=new je(t,c,n,s);return t.computedObjects.set(p,h),h}}function it(e){return Object.assign({loading:!1,timeout:0,retry:0,error:null,result:void 0,progress:0,run:(0,C.markRaw)(G(function(t){})),cancel:(0,C.markRaw)(G(function(){}))},e)}var Ae=d(20649);function se(e,t){var n=e.value,r;n.__COMPUTED__=="async"?r=ue(e,t):n.__COMPUTED__=="sync"?r=ae(e,t):(0,Ae.$)(n)?(e.value=function(){return{getter:n,options:{depends:[],initial:void 0,immediate:!0,enable:!0}}},r=ue(e,t)):(e.value=function(){return{getter:n,options:{initial:void 0,enable:!0}}},r=ae(e,t)),r&&t.emit("computed:created",r)}var ut=d(71698),oe=d.n(ut),st=d(44114),Z=d.n(st),ot=d(19365),ct=d.n(ot),lt=d(72904),ft=d.n(lt),dt=d(65523),ce=d.n(dt),pt=d(7122),le=d.n(pt),vt=d(19108),Ee=d.n(vt);function Me(e,t,n){if(typeof e!="function")throw new Error("computed getter must be a function");var r=[],a={async:!1,enable:!0,timeout:0,depends:[],immediate:!0};if(arguments.length==1)r=[];else if(arguments.length==2)if(Array.isArray(arguments[1]))r=arguments[1];else if(Oe()(arguments[1])=="object")Object.assign(a,arguments[1]);else throw new Error("invalid arguments");else arguments.length>=3&&(r=arguments[1],Object.assign(a,arguments[2]));var i=a.async===!0||(0,Ae.$)(e)||arguments.length>=2&&Array.isArray(t);a.async=i,a.depends=Ge(r);var u=function(){return{getter:e,options:a}};return u.__COMPUTED__=i?"async":"sync",u}function _(){return Math.random().toString(36).slice(2)}function ht(e){return function(t,n){var r=Object.assign({id:_(),scope:e.stateCtx.state,context:e.stateCtx.state},n);if(!Array.isArray(r.depends)||r.depends.length==0)throw new Error("options.depends must be an array and not empty");var a=(0,C.sharex)({}),i={path:[],parent:null,value:Me(t,r.depends,n)};return se(i,e),a}}var Pe=function(e){ce()(n,e);var t=le()(n);function n(r){var a;return K()(this,n),a=t.call(this),$()(Z()(a),"_createComputed",void 0),a.store=r,a}return H()(n,[{key:"runGroup",value:function(){var r=J()(A()().mark(function i(u){return A()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",Promise.all(S()(this.values()).filter(function(l){return l.group==u}).map(function(l){return l.async,l.run()})));case 1:case"end":return o.stop()}},i,this)}));function a(i){return r.apply(this,arguments)}return a}()},{key:"enableGroup",value:function(){var r=J()(A()().mark(function i(u){var s,o,l;return A()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:s=oe()(this.values());try{for(s.s();!(o=s.n()).done;)l=o.value,l.options.enable=u}catch(p){s.e(p)}finally{s.f()}case 2:case"end":return f.stop()}},i,this)}));function a(i){return r.apply(this,arguments)}return a}()},{key:"delete",value:function(a){return ct()(ft()(n.prototype),"delete",this).call(this,a)}},{key:"new",get:function(){return this._createComputed||(this._createComputed=ht(this.store)),this._createComputed}}]),n}(Ee()(Map));function ke(e){return typeof e=="function"?e:typeof e=="string"?function(t){return I(t)==I(e.split(b))}:Array.isArray(e)?function(t){return e.map(function(n){return typeof n=="string"?n.split(b):Array.isArray(n)?n:[String(n)]}).some(function(n){return I(t)==I(n)})}:function(){return!1}}function gt(e,t,n){var r=Object.assign({depends:ke(t),enable:!0},n),a=function(){return{listener:e,options:r}};return a.__COMPUTED__="watch",a}function fe(e){return function(t,n){var r=(0,C.watch)(function(i){var u=i.triggerReasons,s=u.map(function(o){return o.keyPath});t(s)},function(){return n==null?void 0:n.map(function(i){return P(e.stateCtx.state,i)})}),a=r.unwatch;return a}}var yt=d(70079);function de(e,t){t.options.log("install watch for <".concat(e.path.length==0?"Dynamic":e.path.join(b),">"));var n=e.value();n.options.selfPath=e.path;var r=t.watchObjects.add(n),a=n.options.context;return a?a.setState(function(i){i.value=n.options.initial}):(e.replaceValue(n.options.initial),t.stateCtx.setState(function(i){M(i,e.path,n.options.initial)}),(0,C.flush)(t.stateCtx.state)),r}function Te(e){return function(t,n,r){(0,yt.useEffect)(function(){var a={path:["value"],parent:void 0,value:function(){var s={listener:t,options:Object.assign({depends:ke(n),context:(0,C.sharex)({value:0}),selfPath:["value"],initial:0,enable:!0,scope:w.Depends},r)};return s}},i=de(a,e);return function(){e.watchObjects.delete(i.id)}},[n])}}var De=function(){function e(t,n){if(K()(this,e),$()(this,"_cache",void 0),$()(this,"_listener",void 0),$()(this,"_options",void 0),this.store=t,this._options=Object.assign({enable:!0,selfPath:[],group:void 0,context:void 0,initial:void 0},n.options),typeof this._options.depends!="function")throw new Error("watch options.depends must be a function");if(!this._options.id){var r=this._options.selfPath;this._options.id=this._options.id||this._options.context?_():I(r)}this._listener=n.listener}return H()(e,[{key:"id",get:function(){return this._options.id}},{key:"options",get:function(){return this._options}},{key:"selfPath",get:function(){return this._options.selfPath}},{key:"depends",get:function(){return this._options.depends}},{key:"enable",get:function(){return this._options.enable},set:function(n){this._options.enable=n}},{key:"cache",get:function(){return this._cache||(this._cache={}),this._cache}},{key:"value",get:function(){var n=this._options.context?this._options.context:this.store.state;return V((0,C.getSnap)(n),this.selfPath)}},{key:"getName",value:function(){return this._options.context?this.id:this.selfPath.join(b)}},{key:"reset",value:function(){this._cache={}}},{key:"run",value:function(n,r){var a=this;if(!this.enable){this.store.options.log("WatchObject <".concat(this.getName(),"> is disabled"));return}try{var i=this._listener.call(this,r,n,this);i!==void 0&&(this._options.context?this._options.context.setState(function(u){u.value=i}):this.store.setState(function(u){M(u,a.selfPath,i)}))}catch(u){}}}]),e}(),Ie=function(e){ce()(n,e);var t=le()(n);function n(r){var a;return K()(this,n),a=t.call(this),$()(Z()(a),"_off",void 0),$()(Z()(a),"_enable",!0),a.store=r,r.on("created",a.onStateCreated.bind(Z()(a))),a}return H()(n,[{key:"onStateCreated",value:function(){this.createWacher()}},{key:"enable",get:function(){return this._enable},set:function(a){this._enable=a}},{key:"createWacher",value:function(){var a=this,i=(0,C.watch)(function(s){var o=s.triggerReasons;if(a._enable){var l=o.map(function(c){return c.keyPath});l.forEach(function(c){var f=V(a.store.state,c),p=oe()(a.values()),v;try{for(p.s();!(v=p.n()).done;){var g=v.value;g.depends(c,f)&&g.run(c,f)}}catch(h){p.e(h)}finally{p.f()}})}},function(){return[a.store.state]}),u=i.unwatch;this._off=u}},{key:"reset",value:function(){this._off&&this._off(),this.createWacher()}},{key:"add",value:function(a){var i=new De(this.store,a);return this.set(i.id,i),i}},{key:"enableGroup",value:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,u=oe()(this.values()),s;try{for(u.s();!(s=u.n()).done;){var o=s.value;o.options.group==a&&(o.options.enable=i)}}catch(l){u.e(l)}finally{u.f()}}}]),n}(Ee()(Map));function mt(e,t){var n=e.path,r=e.value,a=I(n);typeof r=="function"&&!t._replacedKeys[a]&&!me(r)&&(t._replacedKeys[a]=!0,r.__COMPUTED__=="watch"?de(e,t):se(e,t))}function bt(e){return function(t,n){var r=e.stateCtx.useState;if(t==null)return r();var a=r(),i=x()(a,2),u=i[0],s=i[1],o=t(u),l=s;return typeof n=="function"&&(l=function(f){s(function(p){n.call(p,p,f)})}),[o,l]}}function Ct(e){return function(t){e.reactiveable.setState(function(n){t(n)})}}var Ot=d(24222),St=function(){function e(t,n){K()(this,e)}return H()(e,[{key:"state",get:function(){throw new Error("Method not implemented.")}},{key:"useState",value:function(n,r){throw new Error("Method not implemented.")}},{key:"setState",value:function(n){throw new Error("Method not implemented.")}},{key:"createAsyncComputed",value:function(n){throw new Error("Method not implemented.")}},{key:"createComputed",value:function(n){throw new Error("Method not implemented.")}},{key:"runComputed",value:function(n,r){throw new Error("Method not implemented.")}}]),e}(),jt=function(e){ce()(n,e);var t=le()(n);function n(r,a){var i,u;return K()(this,n),u=t.call(this,r,a),$()(Z()(u),"_stateCtx",void 0),u._stateCtx=(0,C.sharex)(r,{stopArrDep:!1,moduleName:(i=a.id)!==null&&i!==void 0?i:_(),onRead:function(o){a.onRead({path:o.fullKeyPath,value:o.value,parent:o.parent,replaceValue:o.replaceValue})}}),u}return H()(n,[{key:"state",get:function(){return this._stateCtx.reactive}},{key:"useState",value:function(a,i){var u=this._stateCtx.useState(),s=x()(u,2),o=s[0],l=s[1],c=typeof a=="function"?a(o):o,f=typeof i=="function"?function(p){l(function(v){i.call(v,v,p)})}:l;return[c,f]}},{key:"setState",value:function(a){this._stateCtx.setState(a)}},{key:"createAsyncComputed",value:function(a){var i=a.initial,u=a.onComputed,s=a.depends,o=a.options;return this._stateCtx.mutate({deps:function(c){return typeof s=="function"?s(c):null},fn:function(c,f){f.isFirstCall&&typeof i=="function"&&i(c,f)},task:function(){var l=J()(A()().mark(function f(p){var v,g,h,j;return A()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(v=p.draft,g=p.setState,h=p.input,j=p.extraArgs,typeof i!="function"){y.next=3;break}return y.abrupt("return",u({draft:v,setState:g,values:h,options:Object.assign({},j)}));case 3:case"end":return y.stop()}},f)}));function c(f){return l.apply(this,arguments)}return c}(),immediate:o.immediate,desc:o.id,checkDeadCycle:!1}),o.id}},{key:"createComputed",value:function(a){var i=a.onComputed,u=a.options;return this._stateCtx.mutate({fn:function(o,l){var c=l.input;typeof i=="function"&&i({draft:o,values:c})},desc:u.id,checkDeadCycle:!1}),u.id}},{key:"runComputed",value:function(a,i){var u={desc:a,extraArgs:i};this._stateCtx.runMutateTask(u)}}]),n}(St);function wt(e,t){var n=Object.assign({id:_(),debug:!0,onceComputed:!1,enableComputed:!0,scope:function(){return w.Current}},t);n.log=function(){n.debug&&Fe.apply(void 0,arguments)};var r=(0,Ot.Z)(),a={options:n,on:r.on,off:r.off,emit:r.emit,_replacedKeys:{}};return a.computedObjects=new Pe(a),a.watchObjects=new Ie(a),a.reactiveable=new jt(e,{id:n.id,onRead:function(u){mt(u,a)}}),a.state=a.reactiveable.state,a.emit("created"),a.useState=bt(a),a.setState=Ct(a),a.enableComputed=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return a.options.enableComputed=i},a.watch=fe(a),a.useWatch=Te(a),a.watch=fe(a),n.onceComputed&&ze(a.state),a}},43095:function(ye){function D(d){var w=new Error("Cannot find module '"+d+"'");throw w.code="MODULE_NOT_FOUND",w}D.keys=function(){return[]},D.resolve=D,D.id=43095,ye.exports=D}}]);
